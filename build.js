(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
window.Diaporama=require("diaporama"),window.Qajax=require("qajax");
},{"diaporama":9,"qajax":56}],2:[function(require,module,exports){
!function(r){"object"==typeof exports?module.exports=r():"function"==typeof define&&define.amd?define([],r):window.BezierEasing=r()}(function(){function r(r,n,s,c){function g(r,n){return 1-3*n+3*r}function v(r,n){return 3*n-6*r}function w(r){return 3*r}function m(r,n,e){return((g(n,e)*r+v(n,e))*r+w(n))*r}function l(r,n,e){return 3*g(n,e)*r*r+2*v(n,e)*r+w(n)}function d(n,t){for(var i=0;e>i;++i){var u=l(t,r,s);if(0===u)return t;var o=m(t,r,s)-n;t-=o/u}return t}function h(){for(var n=0;o>n;++n)p[n]=m(n*a,r,s)}function y(n,e,t){var o,a,f=0;do a=e+(t-e)/2,o=m(a,r,s)-n,o>0?t=a:e=a;while(Math.abs(o)>i&&++f<u);return a}function E(n){for(var e=0,i=1,u=o-1;i!=u&&p[i]<=n;++i)e+=a;--i;var f=(n-p[i])/(p[i+1]-p[i]),c=e+f*a,g=l(c,r,s);return g>=t?d(n,c):0===g?c:y(n,e,e+a)}function b(){x=!0,(r!=n||s!=c)&&h()}if(4!==arguments.length)throw new Error("BezierEasing requires 4 arguments.");for(var z=0;4>z;++z)if("number"!=typeof arguments[z]||isNaN(arguments[z])||!isFinite(arguments[z]))throw new Error("BezierEasing arguments should be integers.");if(0>r||r>1||0>s||s>1)throw new Error("BezierEasing x values must be in [0, 1] range.");var p=f?new Float32Array(o):new Array(o),x=!1,B=function(e){return x||b(),r===n&&s===c?e:0===e?0:1===e?1:m(E(e),n,c)};B.getControlPoints=function(){return[{x:r,y:n},{x:s,y:c}]};var A=[r,n,s,c],F="BezierEasing("+A+")";B.toString=function(){return F};var S="cubic-bezier("+A+")";return B.toCSS=function(){return S},B}var n=this,e=4,t=.001,i=1e-7,u=10,o=11,a=1/(o-1),f="Float32Array"in n;return r.css={ease:r(.25,.1,.25,1),linear:r(0,0,1,1),"ease-in":r(.42,0,1,1),"ease-out":r(0,0,.58,1),"ease-in-out":r(.42,0,.58,1)},r});


},{}],3:[function(require,module,exports){
function Buffer(t,e){var r=this;if(!(r instanceof Buffer))return new Buffer(t,e);var n,i=typeof t;if("number"===i)n=+t;else if("string"===i)n=Buffer.byteLength(t,e);else{if("object"!==i||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&isArray(t.data)&&(t=t.data),n=+t.length}if(n>kMaxLength)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength.toString(16)+" bytes");0>n?n=0:n>>>=0,Buffer.TYPED_ARRAY_SUPPORT?r=Buffer._augment(new Uint8Array(n)):(r.length=n,r._isBuffer=!0);var f;if(Buffer.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)r._set(t);else if(isArrayish(t))if(Buffer.isBuffer(t))for(f=0;n>f;f++)r[f]=t.readUInt8(f);else for(f=0;n>f;f++)r[f]=(t[f]%256+256)%256;else if("string"===i)r.write(t,0,e);else if("number"===i&&!Buffer.TYPED_ARRAY_SUPPORT)for(f=0;n>f;f++)r[f]=0;return n>0&&n<=Buffer.poolSize&&(r.parent=rootParent),r}function SlowBuffer(t,e){if(!(this instanceof SlowBuffer))return new SlowBuffer(t,e);var r=new Buffer(t,e);return delete r.parent,r}function hexWrite(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var f=e.length;if(f%2!==0)throw new Error("Invalid hex string");n>f/2&&(n=f/2);for(var o=0;n>o;o++){var u=parseInt(e.substr(2*o,2),16);if(isNaN(u))throw new Error("Invalid hex string");t[r+o]=u}return o}function utf8Write(t,e,r,n){var i=blitBuffer(utf8ToBytes(e,t.length-r),t,r,n);return i}function asciiWrite(t,e,r,n){var i=blitBuffer(asciiToBytes(e),t,r,n);return i}function binaryWrite(t,e,r,n){return asciiWrite(t,e,r,n)}function base64Write(t,e,r,n){var i=blitBuffer(base64ToBytes(e),t,r,n);return i}function utf16leWrite(t,e,r,n){var i=blitBuffer(utf16leToBytes(e,t.length-r),t,r,n);return i}function base64Slice(t,e,r){return base64.fromByteArray(0===e&&r===t.length?t:t.slice(e,r))}function utf8Slice(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var f=e;r>f;f++)t[f]<=127?(n+=decodeUtf8Char(i)+String.fromCharCode(t[f]),i=""):i+="%"+t[f].toString(16);return n+decodeUtf8Char(i)}function asciiSlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(127&t[i]);return n}function binarySlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function hexSlice(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",f=e;r>f;f++)i+=toHex(t[f]);return i}function utf16leSlice(t,e,r){for(var n=t.slice(e,r),i="",f=0;f<n.length;f+=2)i+=String.fromCharCode(n[f]+256*n[f+1]);return i}function checkOffset(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,n,i,f){if(!Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>i||f>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range")}function objectWriteUInt16(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,f=Math.min(t.length-r,2);f>i;i++)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function objectWriteUInt32(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,f=Math.min(t.length-r,4);f>i;i++)t[r+i]=e>>>8*(n?i:3-i)&255}function checkIEEE754(t,e,r,n,i,f){if(e>i||f>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function writeFloat(t,e,r,n,i){return i||checkIEEE754(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(t,e,r,n,23,4),r+4}function writeDouble(t,e,r,n,i){return i||checkIEEE754(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(t,e,r,n,52,8),r+8}function base64clean(t){if(t=stringtrim(t).replace(INVALID_BASE64_RE,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function isArrayish(t){return isArray(t)||Buffer.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function toHex(t){return 16>t?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){e=e||1/0;for(var r,n=t.length,i=null,f=[],o=0;n>o;o++){if(r=t.charCodeAt(o),r>55295&&57344>r){if(!i){if(r>56319){(e-=3)>-1&&f.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&f.push(239,191,189);continue}i=r;continue}if(56320>r){(e-=3)>-1&&f.push(239,191,189),i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&((e-=3)>-1&&f.push(239,191,189),i=null);if(128>r){if((e-=1)<0)break;f.push(r)}else if(2048>r){if((e-=2)<0)break;f.push(r>>6|192,63&r|128)}else if(65536>r){if((e-=3)<0)break;f.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(2097152>r))throw new Error("Invalid code point");if((e-=4)<0)break;f.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return f}function asciiToBytes(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,n,i,f=[],o=0;o<t.length&&!((e-=2)<0);o++)r=t.charCodeAt(o),n=r>>8,i=r%256,f.push(i),f.push(n);return f}function base64ToBytes(t){return base64.toByteArray(base64clean(t))}function blitBuffer(t,e,r,n){for(var i=0;n>i&&!(i+r>=e.length||i>=t.length);i++)e[i+r]=t[i];return i}function decodeUtf8Char(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("is-array");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var kMaxLength=1073741823,rootParent={};Buffer.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(r){return!1}}(),Buffer.isBuffer=function(t){return!(null==t||!t._isBuffer)},Buffer.compare=function(t,e){if(!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,f=Math.min(r,n);f>i&&t[i]===e[i];i++);return i!==f&&(r=t[i],n=e[i]),n>r?-1:r>n?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new Buffer(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var n=new Buffer(e),i=0;for(r=0;r<t.length;r++){var f=t[r];f.copy(n,i),i+=f.length}return n},Buffer.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":r=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;case"hex":r=t.length>>>1;break;case"utf8":case"utf-8":r=utf8ToBytes(t).length;break;case"base64":r=base64ToBytes(t).length;break;default:r=t.length}return r},Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0,Buffer.prototype.toString=function(t,e,r){var n=!1;if(e>>>=0,r=void 0===r||r===1/0?this.length:r>>>0,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"binary":return binarySlice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}},Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:Buffer.compare(this,t)},Buffer.prototype.indexOf=function(t,e){function r(t,e,r){for(var n=-1,i=0;r+i<t.length;i++)if(t[r+i]===e[-1===n?0:i-n]){if(-1===n&&(n=i),i-n+1===e.length)return r+n}else n=-1;return-1}if(e>2147483647?e=2147483647:-2147483648>e&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(0>e&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(Buffer.isBuffer(t))return r(this,t,e);if("number"==typeof t)return Buffer.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):r(this,[t],e);throw new TypeError("val must be string, number or Buffer")},Buffer.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},Buffer.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},Buffer.prototype.write=function(t,e,r,n){if(isFinite(e))isFinite(r)||(n=r,r=void 0);else{var i=n;n=e,e=r,r=i}if(e=Number(e)||0,0>r||0>e||e>this.length)throw new RangeError("attempt to write outside buffer bounds");var f=this.length-e;r?(r=Number(r),r>f&&(r=f)):r=f,n=String(n||"utf8").toLowerCase();var o;switch(n){case"hex":o=hexWrite(this,t,e,r);break;case"utf8":case"utf-8":o=utf8Write(this,t,e,r);break;case"ascii":o=asciiWrite(this,t,e,r);break;case"binary":o=binaryWrite(this,t,e,r);break;case"base64":o=base64Write(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=utf16leWrite(this,t,e,r);break;default:throw new TypeError("Unknown encoding: "+n)}return o},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t);var n;if(Buffer.TYPED_ARRAY_SUPPORT)n=Buffer._augment(this.subarray(t,e));else{var i=e-t;n=new Buffer(i,void 0);for(var f=0;i>f;f++)n[f]=this[f+t]}return n.length&&(n.parent=this.parent||this),n},Buffer.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,f=0;++f<e&&(i*=256);)n+=this[t+f]*i;return n},Buffer.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,f=0;++f<e&&(i*=256);)n+=this[t+f]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||checkOffset(t,e,this.length);for(var n=e,i=1,f=this[t+--n];n>0&&(i*=256);)f+=this[t+--n]*i;return i*=128,f>=i&&(f-=Math.pow(2,8*e)),f},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r),0);var i=1,f=0;for(this[e]=255&t;++f<r&&(i*=256);)this[e+f]=t/i>>>0&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r),0);var i=r-1,f=1;for(this[e+i]=255&t;--i>=0&&(f*=256);)this[e+i]=t/f>>>0&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,n){t=+t,e>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=0,f=1,o=0>t?1:0;for(this[e]=255&t;++i<r&&(f*=256);)this[e+i]=(t/f>>0)-o&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){t=+t,e>>>=0,n||checkInt(this,t,e,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=r-1,f=1,o=0>t?1:0;for(this[e+i]=255&t;--i>=0&&(f*=256);)this[e+i]=(t/f>>0)-o&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||checkInt(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&r>n&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;if(1e3>i||!Buffer.TYPED_ARRAY_SUPPORT)for(var f=0;i>f;f++)t[f+e]=this[f+r];else t._set(this.subarray(r,r+i),e);return i},Buffer.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new RangeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var i=utf8ToBytes(t.toString()),f=i.length;for(n=e;r>n;n++)this[n]=i[n%f]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(t){return t.constructor=Buffer,t._isBuffer=!0,t._set=t.set,t.get=BP.get,t.set=BP.set,t.write=BP.write,t.toString=BP.toString,t.toLocaleString=BP.toString,t.toJSON=BP.toJSON,t.equals=BP.equals,t.compare=BP.compare,t.indexOf=BP.indexOf,t.copy=BP.copy,t.slice=BP.slice,t.readUIntLE=BP.readUIntLE,t.readUIntBE=BP.readUIntBE,t.readUInt8=BP.readUInt8,t.readUInt16LE=BP.readUInt16LE,t.readUInt16BE=BP.readUInt16BE,t.readUInt32LE=BP.readUInt32LE,t.readUInt32BE=BP.readUInt32BE,t.readIntLE=BP.readIntLE,t.readIntBE=BP.readIntBE,t.readInt8=BP.readInt8,t.readInt16LE=BP.readInt16LE,t.readInt16BE=BP.readInt16BE,t.readInt32LE=BP.readInt32LE,t.readInt32BE=BP.readInt32BE,t.readFloatLE=BP.readFloatLE,t.readFloatBE=BP.readFloatBE,t.readDoubleLE=BP.readDoubleLE,t.readDoubleBE=BP.readDoubleBE,t.writeUInt8=BP.writeUInt8,t.writeUIntLE=BP.writeUIntLE,t.writeUIntBE=BP.writeUIntBE,t.writeUInt16LE=BP.writeUInt16LE,t.writeUInt16BE=BP.writeUInt16BE,t.writeUInt32LE=BP.writeUInt32LE,t.writeUInt32BE=BP.writeUInt32BE,t.writeIntLE=BP.writeIntLE,t.writeIntBE=BP.writeIntBE,t.writeInt8=BP.writeInt8,t.writeInt16LE=BP.writeInt16LE,t.writeInt16BE=BP.writeInt16BE,t.writeInt32LE=BP.writeInt32LE,t.writeInt32BE=BP.writeInt32BE,t.writeFloatLE=BP.writeFloatLE,t.writeFloatBE=BP.writeFloatBE,t.writeDoubleLE=BP.writeDoubleLE,t.writeDoubleBE=BP.writeDoubleBE,t.fill=BP.fill,t.inspect=BP.inspect,t.toArrayBuffer=BP.toArrayBuffer,t};var INVALID_BASE64_RE=/[^+\/0-9A-z\-]/g;


},{"base64-js":4,"ieee754":5,"is-array":6}],4:[function(require,module,exports){
var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function r(t){var r=t.charCodeAt(0);return r===h||r===u?62:r===c||r===f?63:o>r?-1:o+10>r?r-o+26+26:i+26>r?r-i:A+26>r?r-A+26:void 0}function e(t){function e(t){i[f++]=t}var n,h,c,o,A,i;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=t.length;A="="===t.charAt(u-2)?2:"="===t.charAt(u-1)?1:0,i=new a(3*t.length/4-A),c=A>0?t.length-4:t.length;var f=0;for(n=0,h=0;c>n;n+=4,h+=3)o=r(t.charAt(n))<<18|r(t.charAt(n+1))<<12|r(t.charAt(n+2))<<6|r(t.charAt(n+3)),e((16711680&o)>>16),e((65280&o)>>8),e(255&o);return 2===A?(o=r(t.charAt(n))<<2|r(t.charAt(n+1))>>4,e(255&o)):1===A&&(o=r(t.charAt(n))<<10|r(t.charAt(n+1))<<4|r(t.charAt(n+2))>>2,e(o>>8&255),e(255&o)),i}function n(t){function r(t){return lookup.charAt(t)}function e(t){return r(t>>18&63)+r(t>>12&63)+r(t>>6&63)+r(63&t)}var n,a,h,c=t.length%3,o="";for(n=0,h=t.length-c;h>n;n+=3)a=(t[n]<<16)+(t[n+1]<<8)+t[n+2],o+=e(a);switch(c){case 1:a=t[t.length-1],o+=r(a>>2),o+=r(a<<4&63),o+="==";break;case 2:a=(t[t.length-2]<<8)+t[t.length-1],o+=r(a>>10),o+=r(a>>4&63),o+=r(a<<2&63),o+="="}return o}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,h="+".charCodeAt(0),c="/".charCodeAt(0),o="0".charCodeAt(0),A="a".charCodeAt(0),i="A".charCodeAt(0),u="-".charCodeAt(0),f="_".charCodeAt(0);t.toByteArray=e,t.fromByteArray=n}("undefined"==typeof exports?this.base64js={}:exports);


},{}],5:[function(require,module,exports){
exports.read=function(o,t,a,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,n=a?h-1:0,s=a?-1:1,N=o[t+n];for(n+=s,M=N&(1<<-i)-1,N>>=-i,i+=w;i>0;M=256*M+o[t+n],n+=s,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+o[t+n],n+=s,i-=8);if(0===M)M=1-e;else{if(M===f)return p?0/0:(N?-1:1)*(1/0);p+=Math.pow(2,r),M-=e}return(N?-1:1)*p*Math.pow(2,M-r)},exports.write=function(o,t,a,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,n=i>>1,s=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,N=r?0:M-1,u=r?1:-1,l=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(w=isNaN(t)?1:0,p=i):(p=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-p))<1&&(p--,f*=2),t+=p+n>=1?s/f:s*Math.pow(2,1-n),t*f>=2&&(p++,f/=2),p+n>=i?(w=0,p=i):p+n>=1?(w=(t*f-1)*Math.pow(2,h),p+=n):(w=t*Math.pow(2,n-1)*Math.pow(2,h),p=0));h>=8;o[a+N]=255&w,N+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;o[a+N]=255&p,N+=u,p/=256,e-=8);o[a+N-u]|=128*l};


},{}],6:[function(require,module,exports){
var isArray=Array.isArray,str=Object.prototype.toString;module.exports=isArray||function(r){return!!r&&"[object Array]"==str.call(r)};


},{}],7:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,s,i,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];n.apply(this,i)}else if(isObject(n)){for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];for(o=n.slice(),s=o.length,r=0;s>r;r++)o[r].apply(this,i)}return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned){var n;n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,s,i,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,s=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=i;r-->0;)if(n[r]===t||n[r].listener&&n[r].listener===t){s=r;break}if(0>s)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?isFunction(e._events[t])?1:e._events[t].length:0};


},{}],8:[function(require,module,exports){
function drainQueue(){if(!draining){draining=!0;for(var e,o=queue.length;o;){e=queue,queue=[];for(var r=-1;++r<o;)e[r]();o=queue.length}draining=!1}}function noop(){}var process=module.exports={},queue=[],draining=!1;process.nextTick=function(e){queue.push(e),draining||setTimeout(drainQueue,0)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};


},{}],9:[function(require,module,exports){
module.exports=require("./lib/Diaporama");


},{"./lib/Diaporama":11}],10:[function(require,module,exports){
module.exports={TRANSITION:0,KENBURNS:[1,2,3],CANVAS2D:[4,5,6],sort:function(N,o){return N-o}};


},{}],11:[function(require,module,exports){
function sortSegment(e,t){return Channels.sort(e[1].channel,t[1].channel)}function guessMode(e){if(webglDetector||(webglDetector=new WebGLDetector),e){if("webgl"===e||"canvas"===e)return webglDetector.supported()?"webgl":null}else e=webglDetector.supported()?"webgl":"dom";return e}function createRendering(e,t,i){switch(i){case"webgl":return new DiaporamaRenderingCanvas(e,t);case"dom":return new DiaporamaRenderingDOM(e,t)}return null}function Diaporama(e,t,i){if(!(this instanceof Diaporama))return new Diaporama(e,t,i);if(!e||!e.nodeType)throw new Error("Diaporama: a DOM container is required.");t&&!i&&t.data&&(i=t,t=null),i||(i={}),this._runningSegments=[],this._renderingMode=guessMode(i.renderingMode),this._rendering=createRendering(e,i.backgroundColor||this._backgroundColor,this._renderingMode),delete i.renderingMode,delete i.backgroundColor,this._handleResize=this._handleResize.bind(this),this._handleRender=this._handleRender.bind(this),this._container=e;for(var n in i)this[n]=i[n];t&&(this.data=t),(null===this._width||null===this._height)&&this.fitToContainer();var r=this;this.once("canplaythrough",function(){r._autoplay?r._start():r._requestRender()}),this._requestResize()}var raf=require("raf"),EventEmitter=require("events").EventEmitter,assign=require("object-assign"),Channels=require("./Channels"),findTransitionByName=require("./findTransitionByName"),DiaporamaRenderingCanvas=require("./DiaporamaRenderingCanvas"),DiaporamaRenderingDOM=require("./DiaporamaRenderingDOM"),TimeInterval=require("./TimeInterval"),DiaporamaFormatError=require("./DiaporamaFormatError"),WebGLDetector=require("./WebGLDetector"),RENDER_NO_SEGMENTS=0,RENDER_NOT_READY=1,RENDER_READY=2,webglDetector;Diaporama.prototype=assign({},EventEmitter.prototype,{destroy:function(){this.emit("destroy"),this.removeAllListeners(),this._stopCurrentDiaporamaLoading&&(this._stopCurrentDiaporamaLoading(),this._stopCurrentDiaporamaLoading=null),this._stop(),this._rendering.destroy()},play:function(){this.paused=!1},pause:function(){this.paused=!0},next:function(){var e=this._slideIndexForTime(this._currentTime);if(-1!==e){if(e++,e>=this._slideTimes.length){if(!this._loop)return;e=0}this.currentTime=this._slideTimes[e]}},prev:function(){var e=this._slideIndexForTime(this._currentTime);if(-1!==e){if(e--,0>e){if(!this._loop)return;e=this._slideTimes.length-1}this.currentTime=this._slideTimes[e]}},jump:function(e){if("number"!=typeof e)throw new Error("Diaporama#jump requires the slide index number.");if(!(0>e||e>=this._slideTimes.length)){var t=this._slideIndexForTime(this._currentTime);t!==e&&(this.currentTime=this._slideTimes[e])}},fitToContainer:function(){var e=this._container,t=e.getBoundingClientRect();this._width=t.width,this._height=t.height,this._requestResize()},_playbackRate:1,_loop:!1,_autoplay:!1,_paused:!0,_width:null,_height:null,_resolution:window.devicePixelRatio||1,_currentTime:0,_duration:0,_backgroundColor:[0,0,0],_curLoop:null,_startLoopId:0,_needResize:null,_needRender:null,_loadImages:function(){function e(){l||(l=1,o.emit("canplay"),o._requestRender())}function t(){_||(_=1,o.emit("canplaythrough"),o._requestRender())}function i(){o.emit("load"),o._requestRender()}function n(){if(d.length===u.length)e(),t(),i(),a();else if(l||g&&-1===d.indexOf(g)||e(),l&&!_){var n=Date.now()-c,r=o._duration;.8*d.length/u.length>n/r&&t()}}function r(e){-1!==u.indexOf(e)&&(o.emit("progress",d.length/u.length),d.push(e),n())}function s(e,t){o.emit("error",new Error("Failure to load "+e),t),a()}function a(){h.removeListener("load",r),h.removeListener("error",s),clearInterval(m)}this._stopCurrentDiaporamaLoading&&(this._stopCurrentDiaporamaLoading(),this._stopCurrentDiaporamaLoading=null);var o=this,h=this._rendering.images,u=[],d=[];this._data.timeline.forEach(function(e){var t=e.image;t&&(h.has(t)||u.push(t))});var l,_;if(0===u.length)return e(),t(),void i();var c=Date.now(),g=u[0],m=setInterval(n,200);h.on("load",r),h.on("error",s);for(var p=0;p<u.length;++p)h.load(u[p]);this._stopCurrentDiaporamaLoading=a},_loadTransitions:function(){var e=this._rendering.transitions;if(e){var t=this._data.transitions||this.GlslTransitions||{};this._data.timeline.forEach(function(i){var n=i.transitionNext&&i.transitionNext.name;if(n&&!e.has(n)){var r=findTransitionByName(n,t);r&&e.set(n,r)}})}},_requestResize:function(){null===this._needResize&&(this._needResize=raf(this._handleResize))},_handleResize:function(){null!==this._needResize&&(this._needResize=null,this._resize())},_resize:function(){var e=this._width,t=this._height,i=this._resolution;this._rendering.resize(e,t,i);for(var n=0;n<this._runningSegments.length;++n)this._runningSegments[n][1].resize(e,t,i);this.emit("resize",e,t),this._requestRender()},_computeTimelineSegments:function(){for(var e;e=this._runningSegments.pop();){var t=e[1].leave();t&&this.emit.apply(this,t)}for(var i=this._data,n=i.timeline.length,r=0,s=0,a=[],o=[],h=[],u=0;n>u;u++){a.push(r);var d=i.timeline[u],l=d.duration||0,_=d.transitionNext,c=_&&_.duration||0,g=u===n-1?2:u%2;if(d.image)e=new this._rendering.SegmentKenBurns(Channels.KENBURNS[g],d);else{if(!d.canvas2d)throw new DiaporamaFormatError("timeline item can't be understood as a segment.",d);e=new this._rendering.SegmentCanvas2d(Channels.CANVAS2D[g],d)}o.push([new TimeInterval(r-s,r+l+c),e]),s=c,r+=l,c&&(h.push({interval:new TimeInterval(r,r+c),index:u}),r+=c)}for(var m=[],p=0;p<h.length;++p){var f=h[p],R=f.index,v=R+1<i.timeline.length?R+1:0,D=o[R][1],w=o[v][1],T=i.timeline[R].transitionNext;(0!==v||this._loop)&&m.push([f.interval,new this._rendering.SegmentTransition(Channels.TRANSITION,T,D,w)])}o=m.concat(o),o.sort(sortSegment),this._slideTimes=a,this._segments=o,this._duration=r-s},_slideIndexForTime:function(e){var t=this._slideTimes;if(!t)return-1;if(0>e||e>=this._duration)return-1;for(var i=t.length,n=0;i>n;++n)if(e<t[n])return n-1;return i-1},renderNow:function(){this._needRender=!0,this._handleRender()},_requestRender:function(){null===this._curLoop&&null===this._needRender&&(this._needRender=raf(this._handleRender))},_handleRender:function(){null!==this._needRender&&(this._needRender=null,this._render())},_render:function(){this._handleResize();var e=this._segments;if(0!==e.length){for(var t=this._currentTime,i=this._runningSegments,n=this._rendering,r=!1,s=0;s<e.length;++s){var a=e[s],o=i.indexOf(a),h=-1!==o;if(a[0].timeInside(t)){if(!h){if(!a[1].ready(n)){r=!0;continue}i.push(a);var u=a[1].enter(n);u&&this.emit.apply(this,u)}}else if(h){i.splice(o,1);var d=a[1].leave();d&&this.emit.apply(this,d)}}if(i.sort(sortSegment),i.length>0){for(var l=i.length-1;l>=0;l--){var _=i[l];_[1].render(_[0].interpolate(t))}return this._rendering.switchChannel(i[0][1].channel),r?RENDER_NOT_READY:RENDER_READY}return RENDER_NO_SEGMENTS}},_start:function(){var e,t=this,i=++this._startLoopId;this._curLoop=raf(function n(r){if(t._startLoopId===i){raf(n),e||(e=r,t.emit("play"));var s=r-e;e=r;var a=t._render();a===RENDER_NO_SEGMENTS?t.loop?t.currentTime=0:t._stop(!0):a===RENDER_READY&&(t._currentTime+=s*t._playbackRate)}})},_stop:function(e){this._startLoopId++,null!==this._curLoop&&(raf.cancel(this._curLoop),this._curLoop=null,this.emit("pause"),e&&this.emit("ended"))}}),Object.defineProperties(Diaporama.prototype,{loop:{set:function(e){this._loop=e},get:function(){return this._loop}},autoplay:{set:function(e){this._autoplay=e},get:function(){return this._autoplay}},data:{set:function(e){var t=this._data;t!==e&&(this._data=e,0===e.timeline.length&&this._rendering.emptyChild(),this._computeTimelineSegments(t),this._loadTransitions(),this._loadImages(),this._requestRender())},get:function(){return this._data}},resolution:{set:function(e){e!==this._resolution&&(this._resolution=e,this._requestResize())},get:function(){return this._resolution}},width:{set:function(e){e!==this._width&&(this._width=e,this._requestResize())},get:function(){return this._width}},height:{set:function(e){e!==this._height&&(this._height=e,this._requestResize())},get:function(){return this._height}},currentTime:{set:function(e){e!==this._currentTime&&(this._currentTime=Math.max(0,e),this._requestRender())},get:function(){return this._currentTime}},playbackRate:{set:function(e){this._playbackRate=e},get:function(){return this._playbackRate}},paused:{set:function(e){var t=null===this._curLoop;e!==t&&(e?this._stop():this._start())},get:function(){return null===this._curLoop}},duration:{get:function(){return this._duration},set:function(){throw new Error("Diaporama: duration is a read-only value.")}},renderingMode:{get:function(){return this._renderingMode},set:function(){throw new Error("Diaporama: setting renderingMode afterwards is not supported.")}},backgroundColor:{get:function(){return this._backgroundColor},set:function(){throw new Error("Diaporama: setting backgroundColor afterwards is not supported.")}}}),module.exports=Diaporama;


},{"./Channels":10,"./DiaporamaFormatError":12,"./DiaporamaRenderingCanvas":15,"./DiaporamaRenderingDOM":17,"./TimeInterval":22,"./WebGLDetector":23,"./findTransitionByName":24,"events":7,"object-assign":51,"raf":58}],12:[function(require,module,exports){
function DiaporamaFormatError(r){this.message=r,this.stack=(new Error).stack}DiaporamaFormatError.prototype=new Error,DiaporamaFormatError.prototype.name="DiaporamaFormatError",module.exports=DiaporamaFormatError;


},{}],13:[function(require,module,exports){
function SegmentTransition(t,i,n,e){SegmentTimeline.call(this,t,i),this.segmentFrom=n,this.segmentTo=e}var assign=require("object-assign"),BezierEasing=require("bezier-easing"),SegmentTimeline=require("../SegmentTimeline");SegmentTransition.prototype=assign({},SegmentTimeline.prototype,{ready:function(t){return this.segmentFrom.ready(t)&&this.segmentTo.ready(t)&&(!this.data.name||t.transitions.has(this.data.name))},enter:function(t){var i=this.data,n=t.getChannel(this.segmentFrom.channel),e=t.getChannel(this.segmentTo.channel);this.from=n,this.to=e;var s=t.transitions.getOrFade(i.name);this.transition=s.t,this.transition.load(),this.duration=i.duration||1e3,this.easing=BezierEasing.apply(null,i.easing||[0,0,1,1]);var a=assign({},s.uniforms,i.uniforms||{});this.transition.bind();for(var r in a)this.transition.setUniform(r,a[r]);return this.transition.syncViewport(),["transition",this.data,this.segmentFrom.data,this.segmentTo.data]},resize:function(){this.transition.syncViewport()},leave:function(){return["transitionEnd",this.data,this.segmentFrom.data,this.segmentTo.data]},render:function(t){var i=this.transition;i.setProgress(this.easing(t)),i.setUniform("from",this.from),i.setUniform("to",this.to),i.draw()}}),module.exports=SegmentTransition;


},{"../SegmentTimeline":20,"bezier-easing":2,"object-assign":51}],14:[function(require,module,exports){
function StoreTransitions(t){this.T=t,this.ts={},this.set("fade",GlslTransitionFade)}var GlslTransitionFade=require("glsl-transition-fade");StoreTransitions.prototype={destroy:function(){for(var t in this.ts)this.ts[t].t.destroy();this.ts=null},has:function(t){return t in this.ts},set:function(t,s){var i=this.T(s.glsl);this.ts[t]={t:i,uniforms:s.uniforms||{}}},get:function(t){return this.ts[t]},getOrFade:function(t){return t&&this.ts[t]||this.ts.fade}},module.exports=StoreTransitions;


},{"glsl-transition-fade":54}],15:[function(require,module,exports){
function DiaporamaRenderingCanvas(n,e){this._container=n,this._container.style.backgroundColor="rgb("+e.map(function(n){return~~(255*n)})+")",this._canvases={},this._ctxs={},this.createDOM(),this.images=new StoreImages,this.transitions=new StoreTransitions(this.getChannelContext(Channels.TRANSITION))}var GlslTransitionCore=require("glsl-transition-core"),KenBurns=require("kenburns-webgl"),SegmentTransition=require("./SegmentGlslTransition"),SegmentKenBurns=require("../SegmentKenBurns"),SegmentCanvas2d=require("../SegmentCanvas2d"),StoreTransitions=require("./StoreTransitions"),StoreImages=require("../StoreImages"),Channels=require("../Channels");DiaporamaRenderingCanvas.prototype={SegmentTransition:SegmentTransition,SegmentKenBurns:SegmentKenBurns,SegmentCanvas2d:SegmentCanvas2d,destroy:function(){this.emptyChild(),this.images.destroy(),this.transitions.destroy();for(var n in this._ctxs)this._ctxs[n].destroy&&this._ctxs[n].destroy();this._canvases=null,this._ctxs=null},resize:function(n,e,t){var s=n*t,i=e*t;for(var a in this._canvases){var r=this._canvases[a];r.style.width=n+"px",r.style.height=e+"px",r.width=s,r.height=i}this._container.style.width=n+"px",this._container.style.height=e+"px"},getChannel:function(n){return this._canvases[n]},getChannelContext:function(n){return this._ctxs[n]},switchChannel:function(n){n!==this._c&&this._setChild(this._canvases[n])},createDOM:function(){var n,e;n=document.createElement("canvas"),e=GlslTransitionCore(n),this._attachChannel(Channels.TRANSITION,n,e),Channels.KENBURNS.forEach(function(t){n=document.createElement("canvas"),e=new KenBurns(n),this._attachChannel(t,n,e)},this),Channels.CANVAS2D.forEach(function(t){n=document.createElement("canvas"),e=n.getContext("2d"),this._attachChannel(t,n,e)},this)},emptyChild:function(){return this._setChild()},_attachChannel:function(n,e,t){this._canvases[n]=e,this._ctxs[n]=t},_setChild:function(n){this._c=n;var e=this._container,t=e.children[0];t&&e.removeChild(t),n&&e.appendChild(n)}},module.exports=DiaporamaRenderingCanvas;


},{"../Channels":10,"../SegmentCanvas2d":18,"../SegmentKenBurns":19,"../StoreImages":21,"./SegmentGlslTransition":13,"./StoreTransitions":14,"glsl-transition-core":48,"kenburns-webgl":50}],16:[function(require,module,exports){
function SegmentTransition(e,t,i,n){SegmentTimeline.call(this,e,t),this.segmentFrom=i,this.segmentTo=n}var assign=require("object-assign"),BezierEasing=require("bezier-easing"),SegmentTimeline=require("../SegmentTimeline");SegmentTransition.prototype=assign({},SegmentTimeline.prototype,{ready:function(e){return this.segmentFrom.ready(e)&&this.segmentTo.ready(e)},enter:function(e){var t=this.data,i=e.getChannel(this.segmentFrom.channel),n=e.getChannel(this.segmentTo.channel),s=e.getChannel(this.channel);return i.style.position="absolute",i.style.top=0,i.style.left=0,n.style.position="absolute",n.style.top=0,n.style.left=0,s.appendChild(n),s.appendChild(i),this.container=s,this.from=i,this.to=n,this.duration=t.duration||1e3,this.easing=BezierEasing.apply(null,t.easing||[0,0,1,1]),["transition",t,this.segmentFrom.data,this.segmentTo.data]},resize:function(){},leave:function(){return this.container.removeChild(this.from),this.container.removeChild(this.to),this.from.style.opacity=1,this.to.style.opacity=1,["transitionEnd",this.data,this.segmentFrom.data,this.segmentTo.data]},render:function(e){var t=this.easing(e);this.from.style.opacity=1-t}}),module.exports=SegmentTransition;


},{"../SegmentTimeline":20,"bezier-easing":2,"object-assign":51}],17:[function(require,module,exports){
function DiaporamaRenderingDOM(e,t){this._container=e,this._container.style.backgroundColor="rgb("+t.map(function(e){return~~(255*e)})+")",this._nodes={},this._ctxs={},this.createDOM(),this.images=new StoreImages}var GlslTransitionCore=require("glsl-transition-core"),KenBurnsDOM=require("kenburns-dom"),Channels=require("../Channels"),StoreImages=require("../StoreImages"),SegmentTransition=require("./SegmentDomTransition"),SegmentKenBurns=require("../SegmentKenBurns"),SegmentCanvas2d=require("../SegmentCanvas2d");DiaporamaRenderingDOM.prototype={SegmentTransition:SegmentTransition,SegmentKenBurns:SegmentKenBurns,SegmentCanvas2d:SegmentCanvas2d,destroy:function(){this.emptyChild(),this.images.destroy();for(var e in this._ctxs)this._ctxs[e].destroy&&this._ctxs[e].destroy();this._nodes=null,this._ctxs=null},resize:function(e,t,n){this._w=e,this._h=t;var i=e*n,s=t*n;for(var r in this._nodes){var h=this._nodes[r];h.style.width=e+"px",h.style.height=t+"px","CANVAS"===h.nodeName&&(h.width=i,h.height=s)}this._container.style.width=e+"px",this._container.style.height=t+"px"},getSize:function(){return{width:this._w,height:this._h}},getChannel:function(e){return this._nodes[e]},getChannelContext:function(e){return this._ctxs[e]},switchChannel:function(e){e!==this._c&&(this._c=e,this._setChild(this._nodes[e]))},createDOM:function(){var e=document.createElement("div");this._attachChannel(Channels.TRANSITION,e,e),Channels.KENBURNS.forEach(function(e){var t=document.createElement("div"),n=new KenBurnsDOM(t);n.getViewport=this.getSize.bind(this),this._attachChannel(e,t,n)},this),Channels.CANVAS2D.forEach(function(e){var t=document.createElement("canvas"),n=t.getContext("2d");this._attachChannel(e,t,n)},this)},emptyChild:function(){return this._setChild()},_attachChannel:function(e,t,n){this._nodes[e]=t,this._ctxs[e]=n},_setChild:function(e){var t=this._container,n=t.children[0];n&&t.removeChild(n),e&&t.appendChild(e)}},module.exports=DiaporamaRenderingDOM;


},{"../Channels":10,"../SegmentCanvas2d":18,"../SegmentKenBurns":19,"../StoreImages":21,"./SegmentDomTransition":16,"glsl-transition-core":48,"kenburns-dom":49}],18:[function(require,module,exports){
function SegmentCanvas2d(e,n){SegmentTimeline.call(this,e,n),this._needRender=!1}var assign=require("object-assign"),SegmentTimeline=require("./SegmentTimeline"),rectCrop=require("rect-crop");SegmentCanvas2d.prototype=assign({},SegmentTimeline.prototype,{ready:function(){return!0},enter:function(e){return this.ctx=e.getChannelContext(this.channel),this._render(),["slide",this.data]},resize:function(){this._needRender=!0},leave:function(){return["slideEnd",this.data]},render:function(){this._needRender&&this._render()},_render:function(){this._needRender=!1;var e=this.ctx,n=e.canvas,t=n.width,r=n.height,i=this.data.canvas2d,a=i.size||[1e3,1e3],s=a[0],d=a[1],l=i.background||"black",o=i.draws||[];e.save(),e.fillStyle=l,e.fillRect(0,0,t,r);var c=rectCrop.largest({width:s,height:d},n);e.translate(Math.round(c[0]),Math.round(c[1])),e.scale(c[2]/s,c[3]/d);for(var h=0;h<o.length;++h){var u=o[h];if(u instanceof Array){var g=u.slice(1);e[u[0]].apply(e,g)}else for(var v in u)e[v]=u[v]}e.restore()}}),module.exports=SegmentCanvas2d;


},{"./SegmentTimeline":20,"object-assign":51,"rect-crop":61}],19:[function(require,module,exports){
function SegmentKenBurns(e,t){SegmentTimeline.call(this,e,t),this.clamped=!0}function sameBound(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}var assign=require("object-assign"),rectClamp=require("rect-clamp"),rectCrop=require("rect-crop"),rectMix=require("rect-mix"),BezierEasing=require("bezier-easing"),SegmentTimeline=require("./SegmentTimeline");SegmentKenBurns.prototype=assign({},SegmentTimeline.prototype,{ready:function(e){return e.images.has(this.data.image)},enter:function(e){var t=this.data,n=e.images.get(t.image),i=e.getChannelContext(this.channel);this.kenburns=i,this.image=n,this.div=e.getChannel(this.channel),e.getSize&&(this.getSize=e.getSize.bind(e));var r=rectCrop.largest,s=rectCrop.largest;return t.kenburns&&(t.kenburns.from&&(r=rectCrop.apply(null,t.kenburns.from)),t.kenburns.to&&(s=rectCrop.apply(null,t.kenburns.to))),this.from=r,this.to=s,this.easing=BezierEasing.apply(null,t.kenburns&&t.kenburns.easing||[0,0,1,1]),this.viewport=[0,0,n.width,n.height],this.computeBounds(),i.runStart&&i.runStart(n),["slide",t]},resize:function(){this.computeBounds()},leave:function(){var e=this.kenburns;return e.runEnd&&e.runEnd(),["slideEnd",this.data]},render:function(e){var t=this.image,n=this.kenburns,i=rectMix(this.fromCropBound,this.toCropBound,this.easing(e));this.clamped&&(i=rectClamp(i,this.viewport)),n.draw(t,i)},cropBound:function(e){var t=this.image,n=e(this.getSize?this.getSize():this.div,t);return this.clamped&&(n=rectClamp(n,this.viewport)),n},computeBounds:function(){this.fromCropBound=this.cropBound(this.from),this.toCropBound=this.cropBound(this.to)}}),module.exports=SegmentKenBurns;


},{"./SegmentTimeline":20,"bezier-easing":2,"object-assign":51,"rect-clamp":60,"rect-crop":61,"rect-mix":62}],20:[function(require,module,exports){
function SegmentTimeline(e,n){this.channel=e,this.data=n}var noop=require("./noop");SegmentTimeline.prototype={ready:function(){return!0},enter:noop,leave:noop,render:noop,resize:noop},module.exports=SegmentTimeline;


},{"./noop":26}],21:[function(require,module,exports){
function StoreImages(e){this.imgs={},this._loading=[],this._threshold=e||3,this._queue=[]}var assign=require("object-assign"),EventEmitter=require("events").EventEmitter;StoreImages.prototype=assign({},EventEmitter.prototype,{destroy:function(){this.removeAllListeners(),this.imgs={},this._loading=[],this._queue=[]},has:function(e){return e in this.imgs},get:function(e){return this.imgs[e]},load:function(e){this._loading.length>=this._threshold?this._queue.push(e):this._loadImage(e)},_loadImage:function(e){if(-1===this._loading.indexOf(e)){var t=this,i=new window.Image;i.crossOrigin=!0,this._take(e),i.onload=function(){t._release(e)&&(t.imgs[e]=i,t.emit("load",e,i))},i.onabort=i.onerror=function(i){t._release(e)&&(t.imgs[e]=null,t.emit("error",e,i))},i.src=e}},_take:function(e){this._loading.push(e)},_release:function(e){var t=this._loading.indexOf(e);if(-1===t)return!1;if(this._loading.splice(t,1),this._queue.length>0){var i=this._queue.shift();this._loadImage(i)}return!0}}),module.exports=StoreImages;


},{"events":7,"object-assign":51}],22:[function(require,module,exports){
function TimeInterval(t,e){this.startT=t,this.endT=e}var mix=require("./mix");TimeInterval.prototype={timeInside:function(t){return this.startT<=t&&t<this.endT},interpolate:function(t){return mix(this.startT,this.endT,t)}},module.exports=TimeInterval;


},{"./mix":25}],23:[function(require,module,exports){
function WebGLDetector(){this.canvas=document.createElement("canvas"),this.canvas.addEventListener("webglcontextlost",function(e){e.preventDefault(),this.gl=null}.bind(this),!1)}var webglew=require("webglew");WebGLDetector.prototype={supported:function(){if(this.gl||(this.gl=this.canvas.getContext("webgl")),!this.gl)return!1;var e=webglew(this.gl);return e.OES_texture_float}},module.exports=WebGLDetector;


},{"webglew":53}],24:[function(require,module,exports){
module.exports=function(e,o){for(var r=0;r<o.length;++r)if(o[r].name.toLowerCase()===e.toLowerCase())return o[r]};


},{}],25:[function(require,module,exports){
module.exports=function(t,n,a){return Math.max(0,Math.min(1,(a-t)/(n-t)))};


},{}],26:[function(require,module,exports){
module.exports=function(){};


},{}],27:[function(require,module,exports){
"use strict";function Shader(r){this.gl=r,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function compareAttributes(r,e){return r.name<e.name?-1:1}function createShader(r,e,t,a,i){var o=new Shader(r);return o.update(e,t,a,i),o}var createUniformWrapper=require("./lib/create-uniforms"),createAttributeWrapper=require("./lib/create-attributes"),makeReflect=require("./lib/reflect"),shaderCache=require("./lib/shader-cache"),runtime=require("./lib/runtime-reflect"),proto=Shader.prototype;proto.bind=function(){this.program||this._relink(),this.gl.useProgram(this.program)},proto.dispose=function(){this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},proto.update=function(r,e,t,a){function i(){s.program=shaderCache.program(n,s._vref,s._fref,m,c);for(var r=0;r<t.length;++r)S[r]=n.getUniformLocation(s.program,t[r].name)}if(!e||1===arguments.length){var o=r;r=o.vertex,e=o.fragment,t=o.uniforms,a=o.attributes}var s=this,n=s.gl,h=s._vref;s._vref=shaderCache.shader(n,n.VERTEX_SHADER,r),h&&h.dispose(),s.vertShader=s._vref.shader;var f=this._fref;if(s._fref=shaderCache.shader(n,n.FRAGMENT_SHADER,e),f&&f.dispose(),s.fragShader=s._fref.shader,!t||!a){var p=n.createProgram();if(n.attachShader(p,s.fragShader),n.attachShader(p,s.vertShader),n.linkProgram(p),!n.getProgramParameter(p,n.LINK_STATUS)){var u=n.getProgramInfoLog(p);throw console.error("gl-shader: Error linking program:",u),new Error("gl-shader: Error linking program:"+u)}t=t||runtime.uniforms(n,p),a=a||runtime.attributes(n,p),n.deleteProgram(p)}a=a.slice(),a.sort(compareAttributes);for(var l=[],m=[],c=[],g=0;g<a.length;++g){var d=a[g];if(d.type.indexOf("mat")>=0){for(var v=0|d.type.charAt(d.type.length-1),_=new Array(v),b=0;v>b;++b)_[b]=c.length,m.push(d.name+"["+b+"]"),c.push("number"==typeof d.location?d.location+b:Array.isArray(d.location)&&d.location.length===v&&"number"==typeof d.location[b]?0|d.location[b]:-1);l.push({name:d.name,type:d.type,locations:_})}else l.push({name:d.name,type:d.type,locations:[c.length]}),m.push(d.name),c.push("number"==typeof d.location?0|d.location:-1)}for(var y=0,g=0;g<c.length;++g)if(c[g]<0){for(;c.indexOf(y)>=0;)y+=1;c[g]=y}var S=new Array(t.length);i(),s._relink=i,s.types={uniforms:makeReflect(t),attributes:makeReflect(a)},s.attributes=createAttributeWrapper(n,s,l,c),Object.defineProperty(s,"uniforms",createUniformWrapper(n,s,t,S))},module.exports=createShader;


},{"./lib/create-attributes":28,"./lib/create-uniforms":29,"./lib/reflect":30,"./lib/runtime-reflect":31,"./lib/shader-cache":32}],28:[function(require,module,exports){
"use strict";function ShaderAttribute(t,r,e,i,n,a){this._gl=t,this._wrapper=r,this._index=e,this._locations=i,this._dimension=n,this._constFunc=a}function addVectorAttribute(t,r,e,i,n,a,o){for(var u=["gl","v"],s=[],c=0;n>c;++c)u.push("x"+c),s.push("x"+c);u.push("if(x0.length===void 0){return gl.vertexAttrib"+n+"f(v,"+s.join()+")}else{return gl.vertexAttrib"+n+"fv(v,x0)}");var l=Function.apply(null,u),f=new ShaderAttribute(t,r,e,i,n,l);Object.defineProperty(a,o,{set:function(r){return t.disableVertexAttribArray(i[e]),l(t,i[e],r),r},get:function(){return f},enumerable:!0})}function addMatrixAttribute(t,r,e,i,n,a,o){for(var u=new Array(n),s=new Array(n),c=0;n>c;++c)addVectorAttribute(t,r,e[c],i,n,u,c),s[c]=u[c];Object.defineProperty(u,"location",{set:function(t){if(Array.isArray)for(var r=0;n>r;++r)s[r].location=t[r];else for(var r=0;n>r;++r)result[r]=s[r].location=t+r;return t},get:function(){for(var t=new Array(n),r=0;n>r;++r)t[r]=i[e[r]];return t},enumerable:!0}),u.pointer=function(r,a,o,u){r=r||t.FLOAT,a=!!a,o=o||n*n,u=u||0;for(var s=0;n>s;++s){var c=i[e[s]];t.vertexAttribPointer(c,n,r,a,o,u+s*n),t.enableVertexAttribArray(c)}};var l=new Array(n),f=t["vertexAttrib"+n+"fv"];Object.defineProperty(a,o,{set:function(r){for(var a=0;n>a;++a){var o=i[e[a]];if(t.disableVertexAttribArray(o),Array.isArray(r[0]))f.call(t,o,r[a]);else{for(var u=0;n>u;++u)l[u]=r[n*a+u];f.call(t,o,l)}}return r},get:function(){return u},enumerable:!0})}function createAttributeWrapper(t,r,e,i){for(var n={},a=0,o=e.length;o>a;++a){var u=e[a],s=u.name,c=u.type,l=u.locations;switch(c){case"bool":case"int":case"float":addVectorAttribute(t,r,l[0],i,1,n,s);break;default:if(c.indexOf("vec")>=0){var f=c.charCodeAt(c.length-1)-48;if(2>f||f>4)throw new Error("gl-shader: Invalid data type for attribute "+s+": "+c);addVectorAttribute(t,r,l[0],i,f,n,s)}else{if(!(c.indexOf("mat")>=0))throw new Error("gl-shader: Unknown data type for attribute "+s+": "+c);var f=c.charCodeAt(c.length-1)-48;if(2>f||f>4)throw new Error("gl-shader: Invalid data type for attribute "+s+": "+c);addMatrixAttribute(t,r,l,i,f,n,s)}}}return n}module.exports=createAttributeWrapper;var proto=ShaderAttribute.prototype;proto.pointer=function(t,r,e,i){var n=this,a=n._gl,o=n._locations[n._index];a.vertexAttribPointer(o,n._dimension,t||a.FLOAT,!!r,e||0,i||0),a.enableVertexAttribArray(o)},proto.set=function(t,r,e,i){return this._constFunc(this._locations[this._index],t,r,e,i)},Object.defineProperty(proto,"location",{get:function(){return this._locations[this._index]},set:function(t){return t!==this._locations[this._index]&&(this._locations[this._index]=0|t,this._wrapper.program=null),0|t}});


},{}],29:[function(require,module,exports){
"use strict";function identity(r){var e=new Function("y","return function(){return y}");return e(r)}function createUniformWrapper(r,e,n,t){function a(n){var a=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+n+"])}");return a(r,e,t)}function o(r,e,n){switch(n){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+e+"],obj"+r+")";case"float":return"gl.uniform1f(locations["+e+"],obj"+r+")";default:var t=n.indexOf("vec");if(!(t>=0&&1>=t&&n.length===4+t)){if(0===n.indexOf("mat")&&4===n.length){var a=n.charCodeAt(n.length-1)-48;if(2>a||a>4)throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+n);return"gl.uniformMatrix"+a+"fv(locations["+e+"],false,obj"+r+")"}throw new Error("gl-shader: Unknown uniform data type for "+name+": "+n)}var a=n.charCodeAt(n.length-1)-48;if(2>a||a>4)throw new Error("gl-shader: Invalid data type");switch(n.charAt(0)){case"b":case"i":return"gl.uniform"+a+"iv(locations["+e+"],obj"+r+")";case"v":return"gl.uniform"+a+"fv(locations["+e+"],obj"+r+")";default:throw new Error("gl-shader: Unrecognized data type for vector "+name+": "+n)}}}function i(r,e){if("object"!=typeof e)return[[r,e]];var n=[];for(var t in e){var a=e[t],o=r;o+=parseInt(t)+""===t?"["+t+"]":"."+t,"object"==typeof a?n.push.apply(n,i(o,a)):n.push([o,a])}return n}function u(e){for(var a=["return function updateProperty(obj){"],u=i("",e),f=0;f<u.length;++f){var c=u[f],l=c[0],s=c[1];t[s]&&a.push(o(l,s,n[s].type))}a.push("return obj}");var d=new Function("gl","locations",a.join("\n"));return d(r,t)}function f(r){switch(r){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var e=r.indexOf("vec");if(e>=0&&1>=e&&r.length===4+e){var n=r.charCodeAt(r.length-1)-48;if(2>n||n>4)throw new Error("gl-shader: Invalid data type");return"b"===r.charAt(0)?dup(n,!1):dup(n)}if(0===r.indexOf("mat")&&4===r.length){var n=r.charCodeAt(r.length-1)-48;if(2>n||n>4)throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+r);return dup(n*n)}throw new Error("gl-shader: Unknown uniform data type for "+name+": "+r)}}function c(r,e,o){if("object"==typeof o){var i=l(o);Object.defineProperty(r,e,{get:identity(i),set:u(o),enumerable:!0,configurable:!1})}else t[o]?Object.defineProperty(r,e,{get:a(o),set:u(o),enumerable:!0,configurable:!1}):r[e]=f(n[o].type)}function l(r){var e;if(Array.isArray(r)){e=new Array(r.length);for(var n=0;n<r.length;++n)c(e,n,r[n])}else{e={};for(var t in r)c(e,t,r[t])}return e}var s=coallesceUniforms(n,!0);return{get:identity(l(s)),set:u(s),enumerable:!0,configurable:!0}}var dup=require("dup"),coallesceUniforms=require("./reflect");module.exports=createUniformWrapper;


},{"./reflect":30,"dup":33}],30:[function(require,module,exports){
"use strict";function makeReflectTypes(e,t){for(var n={},l=0;l<e.length;++l)for(var r=e[l].name,a=r.split("."),s=n,g=0;g<a.length;++g){var h=a[g].split("[");if(h.length>1){h[0]in s||(s[h[0]]=[]),s=s[h[0]];for(var i=1;i<h.length;++i){var p=parseInt(h[i]);i<h.length-1||g<a.length-1?(p in s||(s[p]=i<h.length-1?[]:{}),s=s[p]):s[p]=t?l:e[l].type}}else g<a.length-1?(h[0]in s||(s[h[0]]={}),s=s[h[0]]):s[h[0]]=t?l:e[l].type}return n}module.exports=makeReflectTypes;


},{}],31:[function(require,module,exports){
"use strict";function getType(e,t){if(!GL_TABLE){var r=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var T=0;T<r.length;++T){var L=r[T];GL_TABLE[e[L]]=GL_TO_GLSL_TYPES[L]}}return GL_TABLE[t]}function runtimeUniforms(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),T=[],L=0;r>L;++L){var _=e.getActiveUniform(t,L);_&&T.push({name:_.name,type:getType(e,_.type)})}return T}function runtimeAttributes(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),T=[],L=0;r>L;++L){var _=e.getActiveAttrib(t,L);_&&T.push({name:_.name,type:getType(e,_.type)})}return T}exports.uniforms=runtimeUniforms,exports.attributes=runtimeAttributes;var GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},GL_TABLE=null;


},{}],32:[function(require,module,exports){
"use strict";function ShaderReference(r,e,a,t,o,h,n){this.id=r,this.src=e,this.type=a,this.shader=t,this.count=h,this.programs=[],this.cache=n}function ContextCache(r){this.gl=r,this.shaders=[{},{}],this.programs={}}function compileShader(r,e,a){var t=r.createShader(e);if(r.shaderSource(t,a),r.compileShader(t),!r.getShaderParameter(t,r.COMPILE_STATUS)){var o=r.getShaderInfoLog(t);throw console.error("gl-shader: Error compiling shader:",o),new Error("gl-shader: Error compiling shader:"+o)}return t}function linkProgram(r,e,a,t,o){var h=r.createProgram();r.attachShader(h,e),r.attachShader(h,a);for(var n=0;n<t.length;++n)r.bindAttribLocation(h,o[n],t[n]);if(r.linkProgram(h),!r.getProgramParameter(h,r.LINK_STATUS)){var i=r.getProgramInfoLog(h);throw console.error("gl-shader: Error linking program:",i),new Error("gl-shader: Error linking program:"+i)}return h}function getCache(r){var e=CACHE.get(r);return e||(e=new ContextCache(r),CACHE.set(r,e)),e}function getShaderReference(r,e,a){return getCache(r).getShaderReference(e,a)}function createProgram(r,e,a,t,o){return getCache(r).getProgram(e,a,t,o)}exports.shader=getShaderReference,exports.program=createProgram;var weakMap="undefined"==typeof WeakMap?require("weakmap-shim"):WeakMap,CACHE=new weakMap,SHADER_COUNTER=0;ShaderReference.prototype.dispose=function(){if(0===--this.count){for(var r=this.cache,e=r.gl,a=this.programs,t=0,o=a.length;o>t;++t){var h=r.programs[a[t]];h&&(delete r.programs[t],e.deleteProgram(h))}e.deleteShader(this.shader),delete r.shaders[this.type===e.FRAGMENT_SHADER|0][this.src]}};var proto=ContextCache.prototype;proto.getShaderReference=function(r,e){var a=this.gl,t=this.shaders[r===a.FRAGMENT_SHADER|0],o=t[e];if(o)o.count+=1;else{var h=compileShader(a,r,e);o=t[e]=new ShaderReference(SHADER_COUNTER++,e,r,h,[],1,this)}return o},proto.getProgram=function(r,e,a,t){var o=[r.id,e.id,a.join(":"),t.join(":")].join("@"),h=this.programs[o];return h||(this.programs[o]=h=linkProgram(this.gl,r.shader,e.shader,a,t),r.programs.push(o),e.programs.push(o)),h};


},{"weakmap-shim":36}],33:[function(require,module,exports){
"use strict";function dupe_array(e,r,u){var n=0|e[u];if(0>=n)return[];var t,a=new Array(n);if(u===e.length-1)for(t=0;n>t;++t)a[t]=r;else for(t=0;n>t;++t)a[t]=dupe_array(e,r,u+1);return a}function dupe_number(e,r){var u,n;for(u=new Array(e),n=0;e>n;++n)u[n]=r;return u}function dupe(e,r){switch("undefined"==typeof r&&(r=0),typeof e){case"number":if(e>0)return dupe_number(0|e,r);break;case"object":if("number"==typeof e.length)return dupe_array(e,r,0)}return[]}module.exports=dupe;


},{}],34:[function(require,module,exports){
function createStore(){var e={};return function(r){if(("object"!=typeof r||null===r)&&"function"!=typeof r)throw new Error("Weakmap-shim: Key must be object");var t=r.valueOf(e);return t&&t.identity===e?t:hiddenStore(r,e)}}var hiddenStore=require("./hidden-store.js");module.exports=createStore;


},{"./hidden-store.js":35}],35:[function(require,module,exports){
function hiddenStore(e,t){var r={identity:t},n=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?n.apply(this,arguments):r},writable:!0}),r}module.exports=hiddenStore;


},{}],36:[function(require,module,exports){
function weakMap(){var e=createStore();return{get:function(r,t){var a=e(r);return a.hasOwnProperty("value")?a.value:t},set:function(r,t){e(r).value=t},has:function(r){return"value"in e(r)},"delete":function(r){return delete e(r).value}}}var createStore=require("./create-store.js");module.exports=weakMap;


},{"./create-store.js":34}],37:[function(require,module,exports){
"use strict";function fixup(a){if(!a)return EmptyProc;for(var r=0;r<a.args.length;++r){var s=a.args[r];a.args[r]=0===r?{name:s,lvalue:!0,rvalue:!!a.rvalue,count:a.count||1}:{name:s,lvalue:!1,rvalue:!0,count:1}}return a.thisVars||(a.thisVars=[]),a.localVars||(a.localVars=[]),a}function pcompile(a){return compile({args:a.args,pre:fixup(a.pre),body:fixup(a.body),post:fixup(a.proc),funcName:a.funcName})}function makeOp(a){for(var r=[],s=0;s<a.args.length;++s)r.push("a"+s);var i=new Function("P",["return function ",a.funcName,"_ndarrayops(",r.join(","),") {P(",r.join(","),");return a0}"].join(""));return i(pcompile(a))}var compile=require("cwise-compiler"),EmptyProc={body:"",args:[],thisVars:[],localVars:[]},assign_ops={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var a in assign_ops){var r=assign_ops[a];exports[a]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+r+"c"},funcName:a}),exports[a+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a"+r+"=b"},rvalue:!0,funcName:a+"eq"}),exports[a+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+r+"s"},funcName:a+"s"}),exports[a+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a"+r+"=s"},rvalue:!0,funcName:a+"seq"})}}();var unary_ops={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var a in unary_ops){var r=unary_ops[a];exports[a]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a="+r+"b"},funcName:a}),exports[a+"eq"]=makeOp({args:["array"],body:{args:["a"],body:"a="+r+"a"},rvalue:!0,count:2,funcName:a+"eq"})}}();var binary_ops={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var a in binary_ops){var r=binary_ops[a];exports[a]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+r+"c"},funcName:a}),exports[a+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+r+"s"},funcName:a+"s"}),exports[a+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=a"+r+"b"},rvalue:!0,count:2,funcName:a+"eq"}),exports[a+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+r+"s"},rvalue:!0,count:2,funcName:a+"seq"})}}();var math_unary=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var a=0;a<math_unary.length;++a){var r=math_unary[a];exports[r]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:r}),exports[r+"eq"]=makeOp({args:["array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"eq"})}}();var math_comm=["max","min","atan2","pow"];!function(){for(var a=0;a<math_comm.length;++a){var r=math_comm[a];exports[r]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:r}),exports[r+"s"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:r+"s"}),exports[r+"eq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"eq"}),exports[r+"seq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"seq"})}}();var math_noncomm=["atan2","pow"];!function(){for(var a=0;a<math_noncomm.length;++a){var r=math_noncomm[a];exports[r+"op"]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:r+"op"}),exports[r+"ops"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:r+"ops"}),exports[r+"opeq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"opeq"}),exports[r+"opseq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+r,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:r+"opseq"})}}(),exports.any=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),exports.all=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),exports.sum=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),exports.prod=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),exports.norm2squared=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),exports.norm2=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),exports.norminf=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),exports.norm1=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),exports.sup=compile({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),exports.inf=compile({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),exports.argmin=compile({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),exports.argmax=compile({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),exports.random=makeOp({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),exports.assign=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),exports.assigns=makeOp({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),exports.equals=compile({args:["array","array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"});


},{"cwise-compiler":38}],38:[function(require,module,exports){
"use strict";function Procedure(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function compileCwise(r){var e=new Procedure;e.pre=r.pre,e.body=r.body,e.post=r.post;var s=r.args.slice(0);e.argTypes=s;for(var o=0;o<s.length;++o){var t=s[o];if("array"===t){if(e.arrayArgs.push(o),e.shimArgs.push("array"+o),o<e.pre.args.length&&e.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<e.post.args.length&&e.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===t)e.scalarArgs.push(o),e.shimArgs.push("scalar"+o);else if("index"===t){if(e.indexArgs.push(o),o<e.pre.args.length&&e.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<e.body.args.length&&e.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<e.post.args.length&&e.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===t){if(e.shapeArgs.push(o),o<e.pre.args.length&&e.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<e.body.args.length&&e.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<e.post.args.length&&e.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof t||!t.offset)throw new Error("cwise: Unknown argument type "+s[o]);e.argTypes[o]="offset",e.offsetArgs.push({array:t.array,offset:t.offset}),e.offsetArgIndex.push(o)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>s.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>s.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>s.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!r.printCode||!!r.debug,e.funcName=r.funcName||"cwise",e.blockSize=r.blockSize||64,createThunk(e)}var createThunk=require("./lib/thunk.js");module.exports=compileCwise;


},{"./lib/thunk.js":40}],39:[function(require,module,exports){
"use strict";function innerFill(r,n,e){var o,s,a=r.length,i=n.arrayArgs.length,t=n.indexArgs.length>0,p=[],u=[],h=0,f=0;for(o=0;a>o;++o)u.push(["i",o,"=0"].join(""));for(s=0;i>s;++s)for(o=0;a>o;++o)f=h,h=r[o],u.push(0===o?["d",s,"s",o,"=t",s,"p",h].join(""):["d",s,"s",o,"=(t",s,"p",h,"-s",f,"*t",s,"p",f,")"].join(""));for(p.push("var "+u.join(",")),o=a-1;o>=0;--o)h=r[o],p.push(["for(i",o,"=0;i",o,"<s",h,";++i",o,"){"].join(""));for(p.push(e),o=0;a>o;++o){for(f=h,h=r[o],s=0;i>s;++s)p.push(["p",s,"+=d",s,"s",o].join(""));t&&(o>0&&p.push(["index[",f,"]-=s",f].join("")),p.push(["++index[",h,"]"].join(""))),p.push("}")}return p.join("\n")}function outerFill(r,n,e,o){for(var s=n.length,a=e.arrayArgs.length,i=e.blockSize,t=e.indexArgs.length>0,p=[],u=0;a>u;++u)p.push(["var offset",u,"=p",u].join(""));for(var u=r;s>u;++u)p.push(["for(var j"+u+"=SS[",n[u],"]|0;j",u,">0;){"].join("")),p.push(["if(j",u,"<",i,"){"].join("")),p.push(["s",n[u],"=j",u].join("")),p.push(["j",u,"=0"].join("")),p.push(["}else{s",n[u],"=",i].join("")),p.push(["j",u,"-=",i,"}"].join("")),t&&p.push(["index[",n[u],"]=j",u].join(""));for(var u=0;a>u;++u){for(var h=["offset"+u],f=r;s>f;++f)h.push(["j",f,"*t",u,"p",n[f]].join(""));p.push(["p",u,"=(",h.join("+"),")"].join(""))}p.push(innerFill(n,e,o));for(var u=r;s>u;++u)p.push("}");return p.join("\n")}function countMatches(r){for(var n=0,e=r[0].length;e>n;){for(var o=1;o<r.length;++o)if(r[o][n]!==r[0][n])return n;++n}return n}function processBlock(r,n,e){for(var o=r.body,s=[],a=[],i=0;i<r.args.length;++i){var t=r.args[i];if(!(t.count<=0)){var p=new RegExp(t.name,"g"),u="",h=n.arrayArgs.indexOf(i);switch(n.argTypes[i]){case"offset":var f=n.offsetArgIndex.indexOf(i),l=n.offsetArgs[f];h=l.array,u="+q"+f;case"array":u="p"+h+u;var c="l"+i,j="a"+h;1===t.count?"generic"===e[h]?t.lvalue?(s.push(["var ",c,"=",j,".get(",u,")"].join("")),o=o.replace(p,c),a.push([j,".set(",u,",",c,")"].join(""))):o=o.replace(p,[j,".get(",u,")"].join("")):o=o.replace(p,[j,"[",u,"]"].join("")):"generic"===e[h]?(s.push(["var ",c,"=",j,".get(",u,")"].join("")),o=o.replace(p,c),t.lvalue&&a.push([j,".set(",u,",",c,")"].join(""))):(s.push(["var ",c,"=",j,"[",u,"]"].join("")),o=o.replace(p,c),t.lvalue&&a.push([j,"[",u,"]=",c].join("")));break;case"scalar":o=o.replace(p,"Y"+n.scalarArgs.indexOf(i));break;case"index":o=o.replace(p,"index");break;case"shape":o=o.replace(p,"shape")}}}return[s.join("\n"),o,a.join("\n")].join("\n").trim()}function typeSummary(r){for(var n=new Array(r.length),e=!0,o=0;o<r.length;++o){var s=r[o],a=s.match(/\d+/);a=a?a[0]:"",n[o]=0===s.charAt(0)?"u"+s.charAt(1)+a:s.charAt(0)+a,o>0&&(e=e&&n[o]===n[o-1])}return e?n[0]:n.join("")}function generateCWiseOp(r,n){for(var e=0|n[1].length,o=new Array(r.arrayArgs.length),s=new Array(r.arrayArgs.length),a=["SS"],i=["'use strict'"],t=[],p=0;e>p;++p)t.push(["s",p,"=SS[",p,"]"].join(""));for(var u=0;u<r.arrayArgs.length;++u){a.push("a"+u),a.push("t"+u),a.push("p"+u),s[u]=n[2*u],o[u]=n[2*u+1];for(var p=0;e>p;++p)t.push(["t",u,"p",p,"=t",u,"[",p,"]"].join(""))}for(var u=0;u<r.scalarArgs.length;++u)a.push("Y"+u);if(r.shapeArgs.length>0&&t.push("shape=SS.slice(0)"),r.indexArgs.length>0){for(var h=new Array(e),u=0;e>u;++u)h[u]="0";t.push(["index=[",h.join(","),"]"].join(""))}for(var u=0;u<r.offsetArgs.length;++u){for(var f=r.offsetArgs[u],l=[],p=0;p<f.offset.length;++p)0!==f.offset[p]&&l.push(1===f.offset[p]?["t",f.array,"p",p].join(""):[f.offset[p],"*t",f.array,"p",p].join(""));t.push(0===l.length?"q"+u+"=0":["q",u,"=",l.join("+")].join(""))}var c=uniq([].concat(r.pre.thisVars).concat(r.body.thisVars).concat(r.post.thisVars));t=t.concat(c),i.push("var "+t.join(","));for(var u=0;u<r.arrayArgs.length;++u)i.push("p"+u+"|=0");r.pre.body.length>3&&i.push(processBlock(r.pre,r,s));var j=processBlock(r.body,r,s),g=countMatches(o);i.push(e>g?outerFill(g,o[0],r,j):innerFill(o[0],r,j)),r.post.body.length>3&&i.push(processBlock(r.post,r,s)),r.debug&&console.log("Generated cwise routine for ",n,":\n\n",i.join("\n"));var v=[r.funcName||"unnamed","_cwise_loop_",o[0].join("s"),"m",g,typeSummary(s)].join(""),d=new Function(["function ",v,"(",a.join(","),"){",i.join("\n"),"} return ",v].join(""));return d()}var uniq=require("uniq");module.exports=generateCWiseOp;


},{"uniq":41}],40:[function(require,module,exports){
"use strict";function createThunk(r){var a=["'use strict'","var CACHED={}"],e=[],n=r.funcName+"_cwise_thunk";a.push(["return function ",n,"(",r.shimArgs.join(","),"){"].join(""));for(var o=[],s=[],i=[["array",r.arrayArgs[0],".shape"].join("")],u=0;u<r.arrayArgs.length;++u){var p=r.arrayArgs[u];e.push(["t",p,"=array",p,".dtype,","r",p,"=array",p,".order"].join("")),o.push("t"+p),o.push("r"+p),s.push("t"+p),s.push("r"+p+".join()"),i.push("array"+p+".data"),i.push("array"+p+".stride"),i.push("array"+p+".offset|0")}for(var u=0;u<r.scalarArgs.length;++u)i.push("scalar"+r.scalarArgs[u]);e.push(["type=[",s.join(","),"].join()"].join("")),e.push("proc=CACHED[type]"),a.push("var "+e.join(",")),a.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",i.join(","),")}"].join("")),r.debug&&console.log("Generated thunk:",a.join("\n"));var t=new Function("compile",a.join("\n"));return t(compile.bind(void 0,r))}var compile=require("./compile.js");module.exports=createThunk;


},{"./compile.js":39}],41:[function(require,module,exports){
"use strict";function unique_pred(n,e){for(var u=1,t=n.length,i=n[0],r=n[0],o=1;t>o;++o)if(r=i,i=n[o],e(i,r)){if(o===u){u++;continue}n[u++]=i}return n.length=u,n}function unique_eq(n){for(var e=1,u=n.length,t=n[0],i=n[0],r=1;u>r;++r,i=t)if(i=t,t=n[r],t!==i){if(r===e){e++;continue}n[e++]=t}return n.length=e,n}function unique(n,e,u){return 0===n.length?n:e?(u||n.sort(e),unique_pred(n,e)):(u||n.sort(),unique_eq(n))}module.exports=unique;


},{}],42:[function(require,module,exports){
(function (Buffer){
function compare1st(t,r){return t[0]-r[0]}function order(){var t,r=this.stride,e=new Array(r.length);for(t=0;t<e.length;++t)e[t]=[Math.abs(r[t]),t];e.sort(compare1st);var n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=e[t][1];return n}function compileConstructor(t,r){var e=["View",r,"d",t].join("");0>r&&(e="View_Nil"+t);var n="generic"===t;if(-1===r){var o="function "+e+"(a){this.data=a;};var proto="+e+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+e+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+e+"(a){return new "+e+"(a);}",i=new Function(o);return i()}if(0===r){var o="function "+e+"(a,d) {this.data = a;this.offset = d};var proto="+e+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+e+"_copy() {return new "+e+"(this.data,this.offset)};proto.pick=function "+e+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+e+"_get(){return "+(n?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+e+"_set(v){return "+(n?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+e+"(a,b,c,d){return new "+e+"(a,d)}",i=new Function("TrivialArray",o);return i(CACHED_CONSTRUCTORS[t][0])}var o=["'use strict'"],a=iota(r),s=a.map(function(t){return"i"+t}),u="this.offset+"+a.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),p=a.map(function(t){return"b"+t}).join(","),f=a.map(function(t){return"c"+t}).join(",");o.push("function "+e+"(a,"+p+","+f+",d){this.data=a","this.shape=["+p+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+e+".prototype","proto.dtype='"+t+"'","proto.dimension="+r),o.push("Object.defineProperty(proto,'size',{get:function "+e+"_size(){return "+a.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===r?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),4>r?(o.push("function "+e+"_order(){"),2===r?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===r&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+e+"_set("+s.join(",")+",v){"),o.push(n?"return this.data.set("+u+",v)}":"return this.data["+u+"]=v}"),o.push("proto.get=function "+e+"_get("+s.join(",")+"){"),o.push(n?"return this.data.get("+u+")}":"return this.data["+u+"]}"),o.push("proto.index=function "+e+"_index(",s.join(),"){return "+u+"}"),o.push("proto.hi=function "+e+"_hi("+s.join(",")+"){return new "+e+"(this.data,"+a.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+a.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var h=a.map(function(t){return"a"+t+"=this.shape["+t+"]"}),c=a.map(function(t){return"c"+t+"=this.stride["+t+"]"});o.push("proto.lo=function "+e+"_lo("+s.join(",")+"){var b=this.offset,d=0,"+h.join(",")+","+c.join(","));for(var d=0;r>d;++d)o.push("if(typeof i"+d+"==='number'&&i"+d+">=0){d=i"+d+"|0;b+=c"+d+"*d;a"+d+"-=d}");o.push("return new "+e+"(this.data,"+a.map(function(t){return"a"+t}).join(",")+","+a.map(function(t){return"c"+t}).join(",")+",b)}"),o.push("proto.step=function "+e+"_step("+s.join(",")+"){var "+a.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+a.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var d=0;r>d;++d)o.push("if(typeof i"+d+"==='number'){d=i"+d+"|0;if(d<0){c+=b"+d+"*(a"+d+"-1);a"+d+"=ceil(-a"+d+"/d)}else{a"+d+"=ceil(a"+d+"/d)}b"+d+"*=d}");o.push("return new "+e+"(this.data,"+a.map(function(t){return"a"+t}).join(",")+","+a.map(function(t){return"b"+t}).join(",")+",c)}");for(var y=new Array(r),l=new Array(r),d=0;r>d;++d)y[d]="a[i"+d+"]",l[d]="b[i"+d+"]";o.push("proto.transpose=function "+e+"_transpose("+s+"){"+s.map(function(t,r){return t+"=("+t+"===undefined?"+r+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+e+"(this.data,"+y.join(",")+","+l.join(",")+",this.offset)}"),o.push("proto.pick=function "+e+"_pick("+s+"){var a=[],b=[],c=this.offset");for(var d=0;r>d;++d)o.push("if(typeof i"+d+"==='number'&&i"+d+">=0){c=(c+this.stride["+d+"]*i"+d+")|0}else{a.push(this.shape["+d+"]);b.push(this.stride["+d+"])}");o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+e+"(data,shape,stride,offset){return new "+e+"(data,"+a.map(function(t){return"shape["+t+"]"}).join(",")+","+a.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var i=new Function("CTOR_LIST","ORDER",o.join("\n"));return i(CACHED_CONSTRUCTORS[t],order)}function arrayDType(t){if(hasBuffer&&Buffer.isBuffer(t))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function wrappedNDArrayCtor(t,r,e,n){if(void 0===t){var o=CACHED_CONSTRUCTORS.array[0];return o([])}"number"==typeof t&&(t=[t]),void 0===r&&(r=[t.length]);var i=r.length;if(void 0===e){e=new Array(i);for(var a=i-1,s=1;a>=0;--a)e[a]=s,s*=r[a]}if(void 0===n){n=0;for(var a=0;i>a;++a)e[a]<0&&(n-=(r[a]-1)*e[a])}for(var u=arrayDType(t),p=CACHED_CONSTRUCTORS[u];p.length<=i+1;)p.push(compileConstructor(u,p.length-1));var o=p[i+1];return o(t,r,e,n)}var iota=require("iota-array"),hasTypedArrays="undefined"!=typeof Float64Array,hasBuffer="undefined"!=typeof Buffer,CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};module.exports=wrappedNDArrayCtor;


}).call(this,require("buffer").Buffer)
},{"buffer":3,"iota-array":43}],43:[function(require,module,exports){
"use strict";function iota(r){for(var t=new Array(r),o=0;r>o;++o)t[o]=o;return t}module.exports=iota;


},{}],44:[function(require,module,exports){
"use strict";"use restrict";function countTrailingZeros(r){var n=32;return r&=-r,r&&n--,65535&r&&(n-=16),16711935&r&&(n-=8),252645135&r&&(n-=4),858993459&r&&(n-=2),1431655765&r&&(n-=1),n}var INT_BITS=32;exports.INT_BITS=INT_BITS,exports.INT_MAX=2147483647,exports.INT_MIN=-1<<INT_BITS-1,exports.sign=function(r){return(r>0)-(0>r)},exports.abs=function(r){var n=r>>INT_BITS-1;return(r^n)-n},exports.min=function(r,n){return n^(r^n)&-(n>r)},exports.max=function(r,n){return r^(r^n)&-(n>r)},exports.isPow2=function(r){return!(r&r-1||!r)},exports.log2=function(r){var n,t;return n=(r>65535)<<4,r>>>=n,t=(r>255)<<3,r>>>=t,n|=t,t=(r>15)<<2,r>>>=t,n|=t,t=(r>3)<<1,r>>>=t,n|=t,n|r>>1},exports.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0},exports.popCount=function(r){return r-=r>>>1&1431655765,r=(858993459&r)+(r>>>2&858993459),16843009*(r+(r>>>4)&252645135)>>>24},exports.countTrailingZeros=countTrailingZeros,exports.nextPow2=function(r){return r+=0===r,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1},exports.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r-(r>>>1)},exports.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,r&=15,27030>>>r&1};var REVERSE_TABLE=new Array(256);!function(r){for(var n=0;256>n;++n){var t=n,e=n,o=7;for(t>>>=1;t;t>>>=1)e<<=1,e|=1&t,--o;r[n]=e<<o&255}}(REVERSE_TABLE),exports.reverse=function(r){return REVERSE_TABLE[255&r]<<24|REVERSE_TABLE[r>>>8&255]<<16|REVERSE_TABLE[r>>>16&255]<<8|REVERSE_TABLE[r>>>24&255]},exports.interleave2=function(r,n){return r&=65535,r=16711935&(r|r<<8),r=252645135&(r|r<<4),r=858993459&(r|r<<2),r=1431655765&(r|r<<1),n&=65535,n=16711935&(n|n<<8),n=252645135&(n|n<<4),n=858993459&(n|n<<2),n=1431655765&(n|n<<1),r|n<<1},exports.deinterleave2=function(r,n){return r=r>>>n&1431655765,r=858993459&(r|r>>>1),r=252645135&(r|r>>>2),r=16711935&(r|r>>>4),r=65535&(r|r>>>16),r<<16>>16},exports.interleave3=function(r,n,t){return r&=1023,r=4278190335&(r|r<<16),r=251719695&(r|r<<8),r=3272356035&(r|r<<4),r=1227133513&(r|r<<2),n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),r|=n<<1,t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),r|t<<2},exports.deinterleave3=function(r,n){return r=r>>>n&1227133513,r=3272356035&(r|r>>>2),r=251719695&(r|r>>>4),r=4278190335&(r|r>>>8),r=1023&(r|r>>>16),r<<22>>22},exports.nextCombination=function(r){var n=r|r-1;return n+1|(~n&-~n)-1>>>countTrailingZeros(r)+1};


},{}],45:[function(require,module,exports){
"use strict";function dupe_array(e,r,u){var n=0|e[u];if(0>=n)return[];var t,a=new Array(n);if(u===e.length-1)for(t=0;n>t;++t)a[t]=r;else for(t=0;n>t;++t)a[t]=dupe_array(e,r,u+1);return a}function dupe_number(e,r){var u,n;for(u=new Array(e),n=0;e>n;++n)u[n]=r;return u}function dupe(e,r){switch("undefined"==typeof r&&(r=0),typeof e){case"number":if(e>0)return dupe_number(0|e,r);break;case"object":if("number"==typeof e.length)return dupe_array(e,r,0)}return[]}module.exports=dupe;


},{}],46:[function(require,module,exports){
(function (global,Buffer){
"use strict";function freeArrayBuffer(r){if(r){var e=r.length||r.byteLength,t=bits.log2(e);DATA[t].push(r)}}function freeTypedArray(r){freeArrayBuffer(r.buffer)}function mallocArrayBuffer(r){var r=bits.nextPow2(r),e=bits.log2(r),t=DATA[e];return t.length>0?t.pop():new ArrayBuffer(r)}function mallocUint8(r){return new Uint8Array(mallocArrayBuffer(r),0,r)}function mallocUint16(r){return new Uint16Array(mallocArrayBuffer(2*r),0,r)}function mallocUint32(r){return new Uint32Array(mallocArrayBuffer(4*r),0,r)}function mallocInt8(r){return new Int8Array(mallocArrayBuffer(r),0,r)}function mallocInt16(r){return new Int16Array(mallocArrayBuffer(2*r),0,r)}function mallocInt32(r){return new Int32Array(mallocArrayBuffer(4*r),0,r)}function mallocFloat(r){return new Float32Array(mallocArrayBuffer(4*r),0,r)}function mallocDouble(r){return new Float64Array(mallocArrayBuffer(8*r),0,r)}function mallocUint8Clamped(r){return hasUint8C?new Uint8ClampedArray(mallocArrayBuffer(r),0,r):mallocUint8(r)}function mallocDataView(r){return new DataView(mallocArrayBuffer(r),0,r)}function mallocBuffer(r){r=bits.nextPow2(r);var e=bits.log2(r),t=BUFFER[e];return t.length>0?t.pop():new Buffer(r)}var bits=require("bit-twiddle"),dup=require("dup");global.__TYPEDARRAY_POOL||(global.__TYPEDARRAY_POOL={UINT8:dup([32,0]),UINT16:dup([32,0]),UINT32:dup([32,0]),INT8:dup([32,0]),INT16:dup([32,0]),INT32:dup([32,0]),FLOAT:dup([32,0]),DOUBLE:dup([32,0]),DATA:dup([32,0]),UINT8C:dup([32,0]),BUFFER:dup([32,0])});var hasUint8C="undefined"!=typeof Uint8ClampedArray,POOL=global.__TYPEDARRAY_POOL;POOL.UINT8C||(POOL.UINT8C=dup([32,0])),POOL.BUFFER||(POOL.BUFFER=dup([32,0]));var DATA=POOL.DATA,BUFFER=POOL.BUFFER;exports.free=function(r){if(Buffer.isBuffer(r))BUFFER[bits.log2(r.length)].push(r);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(r)&&(r=r.buffer),!r)return;var e=r.length||r.byteLength,t=0|bits.log2(e);DATA[t].push(r)}},exports.freeUint8=exports.freeUint16=exports.freeUint32=exports.freeInt8=exports.freeInt16=exports.freeInt32=exports.freeFloat32=exports.freeFloat=exports.freeFloat64=exports.freeDouble=exports.freeUint8Clamped=exports.freeDataView=freeTypedArray,exports.freeArrayBuffer=freeArrayBuffer,exports.freeBuffer=function(r){BUFFER[bits.log2(r.length)].push(r)},exports.malloc=function(r,e){if(void 0===e||"arraybuffer"===e)return mallocArrayBuffer(r);switch(e){case"uint8":return mallocUint8(r);case"uint16":return mallocUint16(r);case"uint32":return mallocUint32(r);case"int8":return mallocInt8(r);case"int16":return mallocInt16(r);case"int32":return mallocInt32(r);case"float":case"float32":return mallocFloat(r);case"double":case"float64":return mallocDouble(r);case"uint8_clamped":return mallocUint8Clamped(r);case"buffer":return mallocBuffer(r);case"data":case"dataview":return mallocDataView(r);default:return null}return null},exports.mallocArrayBuffer=mallocArrayBuffer,exports.mallocUint8=mallocUint8,exports.mallocUint16=mallocUint16,exports.mallocUint32=mallocUint32,exports.mallocInt8=mallocInt8,exports.mallocInt16=mallocInt16,exports.mallocInt32=mallocInt32,exports.mallocFloat32=exports.mallocFloat=mallocFloat,exports.mallocFloat64=exports.mallocDouble=mallocDouble,exports.mallocUint8Clamped=mallocUint8Clamped,exports.mallocDataView=mallocDataView,exports.mallocBuffer=mallocBuffer,exports.clearCache=function(){for(var r=0;32>r;++r)POOL.UINT8[r].length=0,POOL.UINT16[r].length=0,POOL.UINT32[r].length=0,POOL.INT8[r].length=0,POOL.INT16[r].length=0,POOL.INT32[r].length=0,POOL.FLOAT[r].length=0,POOL.DOUBLE[r].length=0,POOL.UINT8C[r].length=0,DATA[r].length=0,BUFFER[r].length=0};


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"bit-twiddle":44,"buffer":3,"dup":45}],47:[function(require,module,exports){
"use strict";function lazyInitLinearTypes(e){linearTypes=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST],filterTypes=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],wrapTypes=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function reshapeTexture(e,t,r){var a=e.gl,i=a.getParameter(a.MAX_TEXTURE_SIZE);if(0>t||t>i||0>r||r>i)throw new Error("gl-texture2d: Invalid texture size");return e._shape=[t,r],e.bind(),a.texImage2D(a.TEXTURE_2D,0,e.format,t,r,0,e.format,e.type,null),e._mipLevels=[0],e}function Texture2D(e,t,r,a,i,n){this.gl=e,this.handle=t,this.format=i,this.type=n,this._shape=[r,a],this._mipLevels=[0],this._magFilter=e.NEAREST,this._minFilter=e.NEAREST,this._wrapS=e.CLAMP_TO_EDGE,this._wrapT=e.CLAMP_TO_EDGE,this._anisoSamples=1;var s=this,o=[this._wrapS,this._wrapT];Object.defineProperties(o,[{get:function(){return s._wrapS},set:function(e){return s.wrapS=e}},{get:function(){return s._wrapT},set:function(e){return s.wrapT=e}}]),this._wrapVector=o;var E=[this._shape[0],this._shape[1]];Object.defineProperties(E,[{get:function(){return s._shape[0]},set:function(e){return s.width=e}},{get:function(){return s._shape[1]},set:function(e){return s.height=e}}]),this._shapeVector=E}function isPacked(e,t){return 3===e.length?1===t[2]&&t[1]===e[0]*e[2]&&t[0]===e[2]:1===t[0]&&t[1]===e[0]}function texSubImageArray(e,t,r,a,i,n,s,o){var E=o.dtype,T=o.shape.slice();if(T.length<2||T.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var u=0,l=0,h=isPacked(T,o.stride.slice());"float32"===E?u=e.FLOAT:"float64"===E?(u=e.FLOAT,h=!1,E="float32"):"uint8"===E?u=e.UNSIGNED_BYTE:(u=e.UNSIGNED_BYTE,h=!1,E="uint8");var f=1;if(2===T.length)l=e.LUMINANCE,T=[T[0],T[1],1],o=ndarray(o.data,T,[o.stride[0],o.stride[1],1],o.offset);else{if(3!==T.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===T[2])l=e.ALPHA;else if(2===T[2])l=e.LUMINANCE_ALPHA;else if(3===T[2])l=e.RGB;else{if(4!==T[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");l=e.RGBA}f=T[2]}if(l!==e.LUMINANCE&&l!==e.ALPHA||i!==e.LUMINANCE&&i!==e.ALPHA||(l=i),l!==i)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var _=o.size,p=s.indexOf(a)<0;if(p&&s.push(a),u===n&&h)0===o.offset&&o.data.length===_?p?e.texImage2D(e.TEXTURE_2D,a,i,T[0],T[1],0,i,n,o.data):e.texSubImage2D(e.TEXTURE_2D,a,t,r,T[0],T[1],i,n,o.data):p?e.texImage2D(e.TEXTURE_2D,a,i,T[0],T[1],0,i,n,o.data.subarray(o.offset,o.offset+_)):e.texSubImage2D(e.TEXTURE_2D,a,t,r,T[0],T[1],i,n,o.data.subarray(o.offset,o.offset+_));else{var g;g=n===e.FLOAT?pool.mallocFloat32(_):pool.mallocUint8(_);var d=ndarray(g,T,[T[2],T[2]*T[0],1]);u===e.FLOAT&&n===e.UNSIGNED_BYTE?convertFloatToUint8(d,o):ops.assign(d,o),p?e.texImage2D(e.TEXTURE_2D,a,i,T[0],T[1],0,i,n,g.subarray(0,_)):e.texSubImage2D(e.TEXTURE_2D,a,t,r,T[0],T[1],i,n,g.subarray(0,_)),n===e.FLOAT?pool.freeFloat32(g):pool.freeUint8(g)}}function initTexture(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}function createTextureShape(e,t,r,a,i){var n=e.getParameter(e.MAX_TEXTURE_SIZE);if(0>t||t>n||0>r||r>n)throw new Error("gl-texture2d: Invalid texture shape");var s=initTexture(e);return e.texImage2D(e.TEXTURE_2D,0,a,t,r,0,a,i,null),new Texture2D(e,s,t,r,a,i)}function createTextureDOM(e,t,r,a){var i=initTexture(e);return e.texImage2D(e.TEXTURE_2D,0,r,r,a,t),new Texture2D(e,i,0|t.width,0|t.height,r,a)}function createTextureArray(e,t){var r=t.dtype,a=t.shape.slice(),i=e.getParameter(e.MAX_TEXTURE_SIZE);if(a[0]<0||a[0]>i||a[1]<0||a[1]>i)throw new Error("gl-texture2d: Invalid texture size");var n=isPacked(a,t.stride.slice()),s=0;"float32"===r?s=e.FLOAT:"float64"===r?(s=e.FLOAT,n=!1,r="float32"):"uint8"===r?s=e.UNSIGNED_BYTE:(s=e.UNSIGNED_BYTE,n=!1,r="uint8");var o=0;if(2===a.length)o=e.LUMINANCE,a=[a[0],a[1],1],t=ndarray(t.data,a,[t.stride[0],t.stride[1],1],t.offset);else{if(3!==a.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===a[2])o=e.ALPHA;else if(2===a[2])o=e.LUMINANCE_ALPHA;else if(3===a[2])o=e.RGB;else{if(4!==a[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");o=e.RGBA}}s!==e.FLOAT||webglew(e).texture_float||(s=e.UNSIGNED_BYTE,n=!1);var E,T,u=t.size;if(n)E=0===t.offset&&t.data.length===u?t.data:t.data.subarray(t.offset,t.offset+u);else{var l=[a[2],a[2]*a[0],1];T=pool.malloc(u,r);var h=ndarray(T,a,l,0);"float32"!==r&&"float64"!==r||s!==e.UNSIGNED_BYTE?ops.assign(h,t):convertFloatToUint8(h,t),E=T.subarray(0,u)}var f=initTexture(e);return e.texImage2D(e.TEXTURE_2D,0,o,a[0],a[1],0,o,s,E),n||pool.free(T),new Texture2D(e,f,a[1],a[0],o,s)}function createTexture2D(e){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(linearTypes||lazyInitLinearTypes(e),"number"==typeof arguments[1])return createTextureShape(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return createTextureShape(e,0|arguments[1][0],0|arguments[1][1],arguments[2]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var t=arguments[1];if(t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof ImageData)return createTextureDOM(e,t,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if(t.shape&&t.data&&t.stride)return createTextureArray(e,t)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var ndarray=require("ndarray"),ops=require("ndarray-ops"),pool=require("typedarray-pool"),webglew=require("webglew");module.exports=createTexture2D;var linearTypes=null,filterTypes=null,wrapTypes=null,convertFloatToUint8=function(e,t){ops.muls(e,t,255)},proto=Texture2D.prototype;Object.defineProperties(proto,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&linearTypes.indexOf(e)>=0&&(webglew(t).OES_texture_float_linear||(e=t.NEAREST)),filterTypes.indexOf(e)<0)throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&linearTypes.indexOf(e)>=0&&(webglew(t).OES_texture_float_linear||(e=t.NEAREST)),filterTypes.indexOf(e)<0)throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;if(this._anisoSamples=0|Math.max(e,1),t!==this._anisoSamples){var r=webglew(this.gl).EXT_texture_filter_anisotropic;r&&this.gl.texParameterf(this.gl.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){if(this.bind(),wrapTypes.indexOf(e)<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e),this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){if(this.bind(),wrapTypes.indexOf(e)<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e),this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(Array.isArray(e)||(e=[e,e]),2!==e.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var t=0;2>t;++t)if(wrapTypes.indexOf(e[t])<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);this._wrapS=e[0],this._wrapT=e[1];var r=this.gl;return this.bind(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this._wrapS),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this._wrapT),e}},shape:{get:function(){return this._shapeVector},set:function(e){if(Array.isArray(e)){if(2!==e.length)throw new Error("gl-texture2d: Invalid texture shape")}else e=[0|e,0|e];return reshapeTexture(this,0|e[0],0|e[1]),[0|e[0],0|e[1]]}},width:{get:function(){return this._shape[0]},set:function(e){return e=0|e,reshapeTexture(this,e,this._shape[1]),e}},height:{get:function(){return this._shape[1]},set:function(e){return e=0|e,reshapeTexture(this,this._shape[0],e),e}}}),proto.bind=function(e){var t=this.gl;return void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(t.TEXTURE_2D,this.handle),void 0!==e?0|e:t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0},proto.dispose=function(){this.gl.deleteTexture(this.handle)},proto.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var e=Math.min(this._shape[0],this._shape[1]),t=0;e>0;++t,e>>>=1)this._mipLevels.indexOf(t)<0&&this._mipLevels.push(t)},proto.setPixels=function(e,t,r,a){var i=this.gl;if(this.bind(),Array.isArray(t)?(a=r,r=0|t[1],t=0|t[0]):(t=t||0,r=r||0),a=a||0,e instanceof HTMLCanvasElement||e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLVideoElement){var n=this._mipLevels.indexOf(a)<0;n?(i.texImage2D(i.TEXTURE_2D,0,this.format,this.format,this.type,e),this._mipLevels.push(a)):i.texSubImage2D(i.TEXTURE_2D,a,t,r,this.format,this.type,e)}else{if(!(e.shape&&e.stride&&e.data))throw new Error("gl-texture2d: Unsupported data type");if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>a||r+e.shape[0]>this._shape[0]>>>a||0>t||0>r)throw new Error("gl-texture2d: Texture dimensions are out of bounds");texSubImageArray(i,t,r,a,this.format,this.type,this._mipLevels,e)}};


},{"ndarray":42,"ndarray-ops":37,"typedarray-pool":46,"webglew":53}],48:[function(require,module,exports){
function getWebGLContext(t,e){if(t.getContext)for(var n=0;n<CONTEXTS.length;++n)try{var r=t.getContext(CONTEXTS[n],e||{});if(r)return r}catch(o){}}function extend(t){for(var e=1;e<arguments.length;++e){var n=arguments[e];for(var r in n)void 0!==n[r]&&(t[r]=n[r])}return t}function GlslTransitionCore(t,e){function n(){f=[],u=getWebGLContext(t,l),t.addEventListener("webglcontextlost",r,!1),t.addEventListener("webglcontextrestored",o,!1)}function r(t){t.preventDefault(),u=null;for(var e=0;e<f.length;++e)f[e].onContextLost(t)}function o(e){u=getWebGLContext(t,l);var n;for(n=0;n<c.length;++n)c[n](e);for(n=0;n<f.length;++n)f[n].onContextRestored(e)}function i(){u.drawArrays(u.TRIANGLES,0,6)}function s(e){function n(){if(u){x=u.createBuffer(),T=createShader(u,VERTEX_SHADER,e),R={},p={};var t=0;for(var n in T.types.uniforms){var r=T.types.uniforms[n];"sampler2D"===r&&(R[n]=t,t++)}}}function r(){T&&T.dispose(),T=null}function o(){n()}function s(){var e=t.width,n=t.height,r=0,o=e,i=0,s=n;a&&(a.uniforms[RESOLUTION_UNIFORM]=new Float32Array([e,n])),u.bindBuffer(u.ARRAY_BUFFER,x),T.attributes.position.pointer(),u.bufferData(u.ARRAY_BUFFER,new Float32Array([r,i,o,i,r,s,r,s,o,i,o,s]),u.STATIC_DRAW),u.viewport(r,i,o,s)}function l(t){T.uniforms[PROGRESS_UNIFORM]=t}function c(t,e){if(t in R){var n=R[t];u.activeTexture(u.TEXTURE0+n);var r=p[t];r&&r.dispose(),null===e?p[t]=r=createTexture(u,2,2):(u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!0),p[t]=r=createTexture(u,e)),T.uniforms[t]=r.bind(n)}else T.uniforms[t]=e}function d(){var t=!1;return T||(n(),t=!0),a!==T&&(a=T,T.bind(),t=!0),s(),t}function g(){if(a===T&&(a=null),T){for(var t in p)p[t].dispose();p=null,T.dispose(),T=null}}function v(){return T||n(),extend({},T.types.uniforms)}var x,T,R,p,C={getGL:function(){return u},load:function(){T||n()},bind:function(){a!==T&&(a=T,T||n(),T.bind())},isCurrentTransition:function(){return a===T},onContextLost:r,onContextRestored:o,syncViewport:s,setProgress:l,setUniform:c,reset:d,draw:i,destroy:g,getUniforms:v};return f.push(C),C}if(1!==arguments.length||!("getContext"in t))throw new Error("Bad arguments. usage: GlslTransitionCore(canvas)");var u,a,f,l=extend({},e&&e.contextAttributes||{},GlslTransitionCore.defaults.contextAttributes),c=[];return s.onContextLost=function(t){c.push(t)},s.getGL=function(){return u},n(),s}var createShader=require("gl-shader"),createTexture=require("gl-texture2d"),VERTEX_SHADER="attribute vec2 position; void main() { gl_Position = vec4(2.0*position-1.0, 0.0, 1.0);}",PROGRESS_UNIFORM="progress",RESOLUTION_UNIFORM="resolution",CONTEXTS=["webgl","experimental-webgl"];GlslTransitionCore.defaults={contextAttributes:{preserveDrawingBuffer:!0}},GlslTransitionCore.isSupported=function(){var t=document.createElement("canvas");return!!getWebGLContext(t)},module.exports=GlslTransitionCore;


},{"gl-shader":27,"gl-texture2d":47}],49:[function(require,module,exports){
function KenBurnsDOMTrait(t){this.elt=t,"absolute"!==t.style.position&&(t.style.position="relative"),t.style.overflow="hidden"}var prefix=require("vendor-prefix"),transformAttr=prefix("transform"),transformOriginAttr=prefix("transform-origin");KenBurnsDOMTrait.prototype={clamped:!0,rgb:[0,0,0],getViewport:function(){return this.elt.getBoundingClientRect()},abort:function(){this.reset()},_transformForRect:function(t){var e=this.getViewport(),r=e.width/t[2],i=[-t[0]+"px",-t[1]+"px"];return"scale("+r+") translate("+i+")"},_reset:function(){this.elt.style.backgroundColor="rgb("+this.rgb.map(function(t){return 255*t})+")",this.elt.innerHTML=""},_setImage:function(t){t!==this.image&&(this._reset(),this.elt.appendChild(t),t.style.position="absolute",t.style.top=0,t.style.left=0,t.style[transformOriginAttr]="0% 0%",this.image=t)},_positionImage:function(t){this.image.style[transformAttr]=this._transformForRect(t)},runStart:function(t){this._setImage(t)},draw:function(t,e){this._positionImage(e)}},module.exports=KenBurnsDOMTrait;


},{"vendor-prefix":63}],50:[function(require,module,exports){
function KenBurnsWebGLTrait(e){this.canvas=e;var t=this.gl=e.getContext("webgl"),r=this.program=t.createProgram(),i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,vertexShaderSource),t.compileShader(i),t.attachShader(r,i);var a=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,fragmentShaderSource),t.compileShader(a),t.attachShader(r,a),t.linkProgram(r),t.useProgram(r),this.positionLocation=t.getAttribLocation(r,"p"),this.imgResL=t.getUniformLocation(r,"imgRes"),this.posL=t.getUniformLocation(r,"pos"),this.dimL=t.getUniformLocation(r,"dim"),this.bgL=t.getUniformLocation(r,"bg"),this.buffer=t.createBuffer(),this._lastW=e.width,this._lastH=e.height}var vertexShaderSource="uniform vec2 imgRes;uniform vec2 pos;uniform vec2 dim;attribute vec2 p;varying vec2 uv;void main() {uv = pos/imgRes + ((p * vec2(1.,-1.)+1.)/2.) * (dim/imgRes);gl_Position = vec4(p,0.,1.);}",fragmentShaderSource="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D img;uniform vec3 bg;varying vec2 uv;void main() {if(uv.x<0.||uv.x>1.||uv.y<0.||uv.y>1.)gl_FragColor = vec4(bg, 1.0);else gl_FragColor = texture2D(img, uv);}";KenBurnsWebGLTrait.prototype={clamped:!0,rgb:[0,0,0],runStart:function(e){{var t=this.gl;this.canvas}t.useProgram(this.program),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),t.STATIC_DRAW);var r=this.positionLocation;t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.uniform2f(this.imgResL,e.width,e.height),t.uniform3fv(this.bgL,this.rgb);var i=this.texture=t.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,i),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)},runEnd:function(){this.gl.deleteTexture(this.texture)},draw:function(e,t){var r=this.gl,i=this.canvas;(this._lastW!==i.width||this._lastH!==i.height)&&(this._lastW=i.width,this._lastH=i.height,r.viewport(0,0,i.width,i.height)),r.uniform2f(this.posL,t[0],t[1]),r.uniform2f(this.dimL,t[2],t[3]),r.drawArrays(r.TRIANGLES,0,6)},destroy:function(){this.gl.deleteBuffer(this.buffer),this.gl.deleteProgram(this.program)},getViewport:function(){return this.canvas}},module.exports=KenBurnsWebGLTrait;


},{}],51:[function(require,module,exports){
"use strict";function ToObject(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}module.exports=Object.assign||function(e){for(var t,n,r=ToObject(e),c=1;c<arguments.length;c++){t=arguments[c],n=Object.keys(Object(t));for(var o=0;o<n.length;o++)r[n[o]]=t[n[o]]}return r};


},{}],52:[function(require,module,exports){
!function(){"use strict";function e(t){t.permitHostObjects___&&t.permitHostObjects___(e)}function t(e){return!(e.substr(0,_.length)==_&&"___"===e.substr(e.length-3))}function n(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[p];if(t&&t.key===e)return t;if(!l(e))return void 0;t={key:e};try{return s(e,p,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(n){return void 0}}function r(e){return e.prototype=null,Object.freeze(e)}function o(){d||"undefined"==typeof console||(d=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=e);var a=!1;if("function"==typeof WeakMap){var i=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var u=new i,f=Object.freeze({});if(u.set(f,1),1===u.get(f))return void(module.exports=WeakMap);a=!0}}var c=(Object.prototype.hasOwnProperty,Object.getOwnPropertyNames),s=Object.defineProperty,l=Object.isExtensible,_="weakmap:",p=_+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var v=new ArrayBuffer(25),b=new Uint8Array(v);crypto.getRandomValues(b),p=_+"rand:"+Array.prototype.map.call(b,function(e){return(e%36).toString(36)}).join("")+"___"}if(s(Object,"getOwnPropertyNames",{value:function(e){return c(e).filter(t)}}),"getPropertyNames"in Object){var y=Object.getPropertyNames;s(Object,"getPropertyNames",{value:function(e){return y(e).filter(t)}})}!function(){var e=Object.freeze;s(Object,"freeze",{value:function(t){return n(t),e(t)}});var t=Object.seal;s(Object,"seal",{value:function(e){return n(e),t(e)}});var r=Object.preventExtensions;s(Object,"preventExtensions",{value:function(e){return n(e),r(e)}})}();var d=!1,O=0,g=function(){function e(e,t){var r,o=n(e);return o?c in o?o[c]:t:(r=u.indexOf(e),r>=0?f[r]:t)}function t(e){var t=n(e);return t?c in t:u.indexOf(e)>=0}function a(e,t){var r,o=n(e);return o?o[c]=t:(r=u.indexOf(e),r>=0?f[r]=t:(r=u.length,f[r]=t,u[r]=e)),this}function i(e){var t,r,o=n(e);return o?c in o&&delete o[c]:(t=u.indexOf(e),0>t?!1:(r=u.length-1,u[t]=void 0,f[t]=f[r],u[t]=u[r],u.length=r,f.length=r,!0))}this instanceof g||o();var u=[],f=[],c=O++;return Object.create(g.prototype,{get___:{value:r(e)},has___:{value:r(t)},set___:{value:r(a)},delete___:{value:r(i)}})};g.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){return this.set___(e,t)},writable:!0,configurable:!0},"delete":{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof i?!function(){function t(){function t(e,t){return s?c.has(e)?c.get(e):s.get___(e,t):c.get(e,t)}function n(e){return c.has(e)||(s?s.has___(e):!1)}function u(e){var t=!!c["delete"](e);return s?s.delete___(e)||t:t}this instanceof g||o();var f,c=new i,s=void 0,l=!1;return f=a?function(e,t){return c.set(e,t),c.has(e)||(s||(s=new g),s.set(e,t)),this}:function(e,t){if(l)try{c.set(e,t)}catch(n){s||(s=new g),s.set___(e,t)}else c.set(e,t);return this},Object.create(g.prototype,{get___:{value:r(t)},has___:{value:r(n)},set___:{value:r(f)},delete___:{value:r(u)},permitHostObjects___:{value:r(function(t){if(t!==e)throw new Error("bogus call to permitHostObjects___");l=!0})}})}a&&"undefined"!=typeof Proxy&&(Proxy=void 0),t.prototype=g.prototype,module.exports=t,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),module.exports=g)}}();


},{}],53:[function(require,module,exports){
"use strict";function baseName(e){return e.replace(/^[A-Z]+_/,"")}function initWebGLEW(e){var t=WebGLEWStruct.get(e);if(t)return t;for(var r={},a=e.getSupportedExtensions(),n=0;n<a.length;++n){var i=a[n];if(0!==i.indexOf("MOZ_")){var u=e.getExtension(a[n]);if(u)for(;;){r[i]=u;var W=baseName(i);if(W===i)break;i=W}}}return WebGLEWStruct.set(e,r),r}var weakMap="undefined"==typeof WeakMap?require("weak-map"):WeakMap,WebGLEWStruct=new weakMap;module.exports=initWebGLEW;


},{"weak-map":52}],54:[function(require,module,exports){
module.exports={glsl:"#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 resolution;uniform sampler2D from, to;uniform float progress;void main() {vec2 p = gl_FragCoord.xy / resolution;gl_FragColor = mix(texture2D(from, p), texture2D(to, p), progress);}",uniforms:{},id:"7e61b1f44a391f0c0894",name:"fade",owner:"glslioadmin",html_url:"https://gist.github.com/glslioadmin/7e61b1f44a391f0c0894",created_at:"2014-05-16T00:00:00Z",updated_at:"2014-05-16T00:00:00Z",stars:0};


},{}],55:[function(require,module,exports){
(function (process){
!function(t){"use strict";if("function"==typeof bootstrap)bootstrap("promise",t);else if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=t}else{if("undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");self.Q=t()}}(function(){"use strict";function t(t){return function(){return K.apply(t,arguments)}}function n(t){return t===Object(t)}function e(t){return"[object StopIteration]"===et(t)||t instanceof q}function r(t,n){if(V&&n.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(rt)){for(var e=[],r=n;r;r=r.source)r.stack&&e.unshift(r.stack);e.unshift(t.stack);var i=e.join("\n"+rt+"\n");t.stack=o(i)}}function o(t){for(var n=t.split("\n"),e=[],r=0;r<n.length;++r){var o=n[r];c(o)||i(o)||!o||e.push(o)}return e.join("\n")}function i(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function u(t){var n=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(n)return[n[1],Number(n[2])];var e=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(e)return[e[1],Number(e[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function c(t){var n=u(t);if(!n)return!1;var e=n[0],r=n[1];return e===_&&r>=z&&ct>=r}function s(){if(V)try{throw new Error}catch(t){var n=t.stack.split("\n"),e=n[0].indexOf("@")>0?n[1]:n[2],r=u(e);if(!r)return;return _=r[0],r[1]}}function f(t,n,e){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(n+" is deprecated, use "+e+" instead.",new Error("").stack),t.apply(t,arguments)}}function p(t){return t instanceof h?t:g(t)?E(t):O(t)}function a(){function t(t){n=t,i.source=t,W(e,function(n,e){p.nextTick(function(){t.promiseDispatch.apply(t,e)})},void 0),e=void 0,r=void 0}var n,e=[],r=[],o=Z(a.prototype),i=Z(h.prototype);if(i.promiseDispatch=function(t,o,i){var u=L(arguments);e?(e.push(u),"when"===o&&i[1]&&r.push(i[1])):p.nextTick(function(){n.promiseDispatch.apply(n,u)})},i.valueOf=function(){if(e)return i;var t=v(n);return m(t)&&(n=t),t},i.inspect=function(){return n?n.inspect():{state:"pending"}},p.longStackSupport&&V)try{throw new Error}catch(u){i.stack=u.stack.substring(u.stack.indexOf("\n")+1)}return o.promise=i,o.resolve=function(e){n||t(p(e))},o.fulfill=function(e){n||t(O(e))},o.reject=function(e){n||t(R(e))},o.notify=function(t){n||W(r,function(n,e){p.nextTick(function(){e(t)})},void 0)},o}function l(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var n=a();try{t(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}return n.promise}function d(t){return l(function(n,e){for(var r=0,o=t.length;o>r;r++)p(t[r]).then(n,e)})}function h(t,n,e){void 0===n&&(n=function(t){return R(new Error("Promise does not support operation: "+t))}),void 0===e&&(e=function(){return{state:"unknown"}});var r=Z(h.prototype);if(r.promiseDispatch=function(e,o,i){var u;try{u=t[o]?t[o].apply(r,i):n.call(r,o,i)}catch(c){u=R(c)}e&&e(u)},r.inspect=e,e){var o=e();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var t=e();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function y(t,n,e,r){return p(t).then(n,e,r)}function v(t){if(m(t)){var n=t.inspect();if("fulfilled"===n.state)return n.value}return t}function m(t){return t instanceof h}function g(t){return n(t)&&"function"==typeof t.then}function k(t){return m(t)&&"pending"===t.inspect().state}function j(t){return!m(t)||"fulfilled"===t.inspect().state}function w(t){return m(t)&&"rejected"===t.inspect().state}function x(){ot.length=0,it.length=0,ut||(ut=!0)}function b(t,n){ut&&(it.push(t),ot.push(n&&"undefined"!=typeof n.stack?n.stack:"(no stack) "+n))}function T(t){if(ut){var n=X(it,t);-1!==n&&(it.splice(n,1),ot.splice(n,1))}}function R(t){var n=h({when:function(n){return n&&T(this),n?n(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return b(n,t),n}function O(t){return h({when:function(){return t},get:function(n){return t[n]},set:function(n,e){t[n]=e},"delete":function(n){delete t[n]},post:function(n,e){return null===n||void 0===n?t.apply(void 0,e):t[n].apply(t,e)},apply:function(n,e){return t.apply(n,e)},keys:function(){return nt(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function E(t){var n=a();return p.nextTick(function(){try{t.then(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}}),n.promise}function S(t){return h({isDef:function(){}},function(n,e){return A(t,n,e)},function(){return p(t).inspect()})}function N(t,n,e){return p(t).spread(n,e)}function D(t){return function(){function n(t,n){var u;if("undefined"==typeof StopIteration){try{u=r[t](n)}catch(c){return R(c)}return u.done?p(u.value):y(u.value,o,i)}try{u=r[t](n)}catch(c){return e(c)?p(c.value):R(c)}return y(u,o,i)}var r=t.apply(this,arguments),o=n.bind(n,"next"),i=n.bind(n,"throw");return o()}}function P(t){p.done(p.async(t)())}function C(t){throw new q(t)}function I(t){return function(){return N([this,U(arguments)],function(n,e){return t.apply(n,e)})}}function A(t,n,e){return p(t).dispatch(n,e)}function U(t){return y(t,function(t){var n=0,e=a();return W(t,function(r,o,i){var u;m(o)&&"fulfilled"===(u=o.inspect()).state?t[i]=u.value:(++n,y(o,function(r){t[i]=r,0===--n&&e.resolve(t)},e.reject,function(t){e.notify({index:i,value:t})}))},void 0),0===n&&e.resolve(t),e.promise})}function F(t){if(0===t.length)return p.resolve();var n=p.defer(),e=0;return W(t,function(r,o,i){function u(t){n.resolve(t)}function c(){e--,0===e&&n.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function s(t){n.notify({index:i,value:t})}var f=t[i];e++,y(f,u,c,s)},void 0),n.promise}function M(t){return y(t,function(t){return t=Y(t,p),y(U(Y(t,function(t){return y(t,H,H)})),function(){return t})})}function Q(t){return p(t).allSettled()}function B(t,n){return p(t).then(void 0,void 0,n)}function $(t,n){return p(t).nodeify(n)}var V=!1;try{throw new Error}catch(G){V=!!G.stack}var _,q,z=s(),H=function(){},J=function(){function t(){for(;n.next;){n=n.next;var e=n.task;n.task=void 0;var o=n.domain;o&&(n.domain=void 0,o.enter());try{e()}catch(u){if(i)throw o&&o.exit(),setTimeout(t,0),o&&o.enter(),u;setTimeout(function(){throw u},0)}o&&o.exit()}r=!1}var n={task:void 0,next:null},e=n,r=!1,o=void 0,i=!1;if(J=function(t){e=e.next={task:t,domain:i&&process.domain,next:null},r||(r=!0,o())},"undefined"!=typeof process&&process.nextTick)i=!0,o=function(){process.nextTick(t)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){o=c,u.port1.onmessage=t,t()};var c=function(){u.port2.postMessage(0)};o=function(){setTimeout(t,0),c()}}else o=function(){setTimeout(t,0)};return J}(),K=Function.call,L=t(Array.prototype.slice),W=t(Array.prototype.reduce||function(t,n){var e=0,r=this.length;if(1===arguments.length)for(;;){if(e in this){n=this[e++];break}if(++e>=r)throw new TypeError}for(;r>e;e++)e in this&&(n=t(n,this[e],e));return n}),X=t(Array.prototype.indexOf||function(t){for(var n=0;n<this.length;n++)if(this[n]===t)return n;return-1}),Y=t(Array.prototype.map||function(t,n){var e=this,r=[];return W(e,function(o,i,u){r.push(t.call(n,i,u,e))},void 0),r}),Z=Object.create||function(t){function n(){}return n.prototype=t,new n},tt=t(Object.prototype.hasOwnProperty),nt=Object.keys||function(t){var n=[];for(var e in t)tt(t,e)&&n.push(e);return n},et=t(Object.prototype.toString);q="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var rt="From previous event:";p.resolve=p,p.nextTick=J,p.longStackSupport=!1,"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(p.longStackSupport=!0),p.defer=a,a.prototype.makeNodeResolver=function(){var t=this;return function(n,e){n?t.reject(n):t.resolve(arguments.length>2?L(arguments,1):e)}},p.Promise=l,p.promise=l,l.race=d,l.all=U,l.reject=R,l.resolve=p,p.passByCopy=function(t){return t},h.prototype.passByCopy=function(){return this},p.join=function(t,n){return p(t).join(n)},h.prototype.join=function(t){return p([this,t]).spread(function(t,n){if(t===n)return t;throw new Error("Can't join: not the same: "+t+" "+n)})},p.race=d,h.prototype.race=function(){return this.then(p.race)},p.makePromise=h,h.prototype.toString=function(){return"[object Promise]"},h.prototype.then=function(t,n,e){function o(n){try{return"function"==typeof t?t(n):n}catch(e){return R(e)}}function i(t){if("function"==typeof n){r(t,c);try{return n(t)}catch(e){return R(e)}}return R(t)}function u(t){return"function"==typeof e?e(t):t}var c=this,s=a(),f=!1;return p.nextTick(function(){c.promiseDispatch(function(t){f||(f=!0,s.resolve(o(t)))},"when",[function(t){f||(f=!0,s.resolve(i(t)))}])}),c.promiseDispatch(void 0,"when",[void 0,function(t){var n,e=!1;try{n=u(t)}catch(r){if(e=!0,!p.onerror)throw r;p.onerror(r)}e||s.notify(n)}]),s.promise},p.tap=function(t,n){return p(t).tap(n)},h.prototype.tap=function(t){return t=p(t),this.then(function(n){return t.fcall(n).thenResolve(n)})},p.when=y,h.prototype.thenResolve=function(t){return this.then(function(){return t})},p.thenResolve=function(t,n){return p(t).thenResolve(n)},h.prototype.thenReject=function(t){return this.then(function(){throw t})},p.thenReject=function(t,n){return p(t).thenReject(n)},p.nearer=v,p.isPromise=m,p.isPromiseAlike=g,p.isPending=k,h.prototype.isPending=function(){return"pending"===this.inspect().state},p.isFulfilled=j,h.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},p.isRejected=w,h.prototype.isRejected=function(){return"rejected"===this.inspect().state};var ot=[],it=[],ut=!0;p.resetUnhandledRejections=x,p.getUnhandledReasons=function(){return ot.slice()},p.stopUnhandledRejectionTracking=function(){x(),ut=!1},x(),p.reject=R,p.fulfill=O,p.master=S,p.spread=N,h.prototype.spread=function(t,n){return this.all().then(function(n){return t.apply(void 0,n)},n)},p.async=D,p.spawn=P,p["return"]=C,p.promised=I,p.dispatch=A,h.prototype.dispatch=function(t,n){var e=this,r=a();return p.nextTick(function(){e.promiseDispatch(r.resolve,t,n)}),r.promise},p.get=function(t,n){return p(t).dispatch("get",[n])},h.prototype.get=function(t){return this.dispatch("get",[t])},p.set=function(t,n,e){return p(t).dispatch("set",[n,e])},h.prototype.set=function(t,n){return this.dispatch("set",[t,n])},p.del=p["delete"]=function(t,n){return p(t).dispatch("delete",[n])},h.prototype.del=h.prototype["delete"]=function(t){return this.dispatch("delete",[t])},p.mapply=p.post=function(t,n,e){return p(t).dispatch("post",[n,e])},h.prototype.mapply=h.prototype.post=function(t,n){return this.dispatch("post",[t,n])},p.send=p.mcall=p.invoke=function(t,n){return p(t).dispatch("post",[n,L(arguments,2)])},h.prototype.send=h.prototype.mcall=h.prototype.invoke=function(t){return this.dispatch("post",[t,L(arguments,1)])},p.fapply=function(t,n){return p(t).dispatch("apply",[void 0,n])},h.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},p["try"]=p.fcall=function(t){return p(t).dispatch("apply",[void 0,L(arguments,1)])},h.prototype.fcall=function(){return this.dispatch("apply",[void 0,L(arguments)])},p.fbind=function(t){var n=p(t),e=L(arguments,1);return function(){return n.dispatch("apply",[this,e.concat(L(arguments))])}},h.prototype.fbind=function(){var t=this,n=L(arguments);return function(){return t.dispatch("apply",[this,n.concat(L(arguments))])}},p.keys=function(t){return p(t).dispatch("keys",[])},h.prototype.keys=function(){return this.dispatch("keys",[])},p.all=U,h.prototype.all=function(){return U(this)},p.any=F,h.prototype.any=function(){return F(this)},p.allResolved=f(M,"allResolved","allSettled"),h.prototype.allResolved=function(){return M(this)},p.allSettled=Q,h.prototype.allSettled=function(){return this.then(function(t){return U(Y(t,function(t){function n(){return t.inspect()}return t=p(t),t.then(n,n)}))})},p.fail=p["catch"]=function(t,n){return p(t).then(void 0,n)},h.prototype.fail=h.prototype["catch"]=function(t){return this.then(void 0,t)},p.progress=B,h.prototype.progress=function(t){return this.then(void 0,void 0,t)},p.fin=p["finally"]=function(t,n){return p(t)["finally"](n)},h.prototype.fin=h.prototype["finally"]=function(t){return t=p(t),this.then(function(n){return t.fcall().then(function(){return n})},function(n){return t.fcall().then(function(){throw n})})},p.done=function(t,n,e,r){return p(t).done(n,e,r)},h.prototype.done=function(t,n,e){var o=function(t){p.nextTick(function(){if(r(t,i),!p.onerror)throw t;p.onerror(t)})},i=t||n||e?this.then(t,n,e):this;"object"==typeof process&&process&&process.domain&&(o=process.domain.bind(o)),i.then(void 0,o)},p.timeout=function(t,n,e){return p(t).timeout(n,e)},h.prototype.timeout=function(t,n){var e=a(),r=setTimeout(function(){n&&"string"!=typeof n||(n=new Error(n||"Timed out after "+t+" ms"),n.code="ETIMEDOUT"),e.reject(n)},t);return this.then(function(t){clearTimeout(r),e.resolve(t)},function(t){clearTimeout(r),e.reject(t)},e.notify),e.promise},p.delay=function(t,n){return void 0===n&&(n=t,t=void 0),p(t).delay(n)},h.prototype.delay=function(t){return this.then(function(n){var e=a();return setTimeout(function(){e.resolve(n)},t),e.promise})},p.nfapply=function(t,n){return p(t).nfapply(n)},h.prototype.nfapply=function(t){var n=a(),e=L(t);return e.push(n.makeNodeResolver()),this.fapply(e).fail(n.reject),n.promise},p.nfcall=function(t){var n=L(arguments,1);return p(t).nfapply(n)},h.prototype.nfcall=function(){var t=L(arguments),n=a();return t.push(n.makeNodeResolver()),this.fapply(t).fail(n.reject),n.promise},p.nfbind=p.denodeify=function(t){var n=L(arguments,1);return function(){var e=n.concat(L(arguments)),r=a();return e.push(r.makeNodeResolver()),p(t).fapply(e).fail(r.reject),r.promise}},h.prototype.nfbind=h.prototype.denodeify=function(){var t=L(arguments);return t.unshift(this),p.denodeify.apply(void 0,t)},p.nbind=function(t,n){var e=L(arguments,2);return function(){function r(){return t.apply(n,arguments)}var o=e.concat(L(arguments)),i=a();return o.push(i.makeNodeResolver()),p(r).fapply(o).fail(i.reject),i.promise}},h.prototype.nbind=function(){var t=L(arguments,0);return t.unshift(this),p.nbind.apply(void 0,t)},p.nmapply=p.npost=function(t,n,e){return p(t).npost(n,e)},h.prototype.nmapply=h.prototype.npost=function(t,n){var e=L(n||[]),r=a();return e.push(r.makeNodeResolver()),this.dispatch("post",[t,e]).fail(r.reject),r.promise},p.nsend=p.nmcall=p.ninvoke=function(t,n){var e=L(arguments,2),r=a();return e.push(r.makeNodeResolver()),p(t).dispatch("post",[n,e]).fail(r.reject),r.promise},h.prototype.nsend=h.prototype.nmcall=h.prototype.ninvoke=function(t){var n=L(arguments,1),e=a();return n.push(e.makeNodeResolver()),this.dispatch("post",[t,n]).fail(e.reject),e.promise},p.nodeify=$,h.prototype.nodeify=function(t){return t?void this.then(function(n){p.nextTick(function(){t(null,n)})},function(n){p.nextTick(function(){t(n)})}):this};var ct=s();return p});


}).call(this,require('_process'))
},{"_process":8}],56:[function(require,module,exports){
module.exports=require("./qajax")(require("q"),window.XMLHttpRequest);


},{"./qajax":57,"q":55}],57:[function(require,module,exports){
!function(t,e){"object"==typeof exports?module.exports=e:"function"==typeof define&&define.amd?define(["q"],function(n){return e(n,t.XMLHttpRequest)}):t.Qajax=e(t.Q,t.XMLHttpRequest)}(this,function(t,e){"use strict";function n(){}function r(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&n.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n.join("&")}function i(t){return-1===t.indexOf("?")}function o(t){var e={};if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function s(e,n){if(0===arguments.length)throw new Error("Qajax: settings are required");var s;if("string"==typeof e)s="object"==typeof n&&n||{},s.url=e;else{if("object"!=typeof e)throw new Error("Qajax: settings must be an object");s=e}if(!s.url)throw new Error("Qajax: settings.url is required");if("cancellation"in s&&!t.isPromiseAlike(s.cancellation))throw new Error("cancellation must be a Promise.");this.headers=o(this.headers),this.params={};for(var a in s)this[a]=s[a];var c=this.params,f=this.cache;f&&(c[f===!0?"_":f]=(new Date).getTime());var h=this.base+this.url,l=r(c);l&&(h=h+(i(h)?"?":"&")+l),this.url=h;var d=this.data,p=this.headers;null!==d&&"object"==typeof d&&(u in p||(p[u]="application/json"),this.data=JSON.stringify(d));var w=this._send,y=this;this.send=function(){return t.fcall(function(){return w.call(y)})}}function a(t,e){return new s(t,e).send()}var u="Content-Type",c=t.defer().promise;return s.prototype={log:n,timeout:6e4,cache:"undefined"==typeof window?!1:!!(window.ActiveXObject||"ActiveXObject"in window),method:"GET",base:"",withCredentials:!1,cancellation:c,_send:function(){var n=new e,r=t.defer(),i=this.log,o=this.method,s=this.url;n.onreadystatechange=function(){if(4===n.readyState)try{i(o+" "+s+" => "+n.status),n.status?r.resolve(n):r.reject(n)}catch(t){r.reject(n)}},n.onprogress=function(t){r.notify(t)},n.open(o,s,!0),this.responseType&&(n.responseType=this.responseType);var a=this.headers;for(var u in a)a.hasOwnProperty(u)&&n.setRequestHeader(u,a[u]);this.withCredentials&&(n.withCredentials=!0);var c=this.data;return void 0!==c&&null!==c?n.send(c):n.send(),this.cancellation.fin(function(){r.promise.isFulfilled()||(i("Qajax cancellation reached."),n.abort())}),this.timeout?r.promise.timeout(this.timeout).fail(function(t){throw t instanceof Error&&(i("Qajax request delay reach in "+o+" "+s),n.abort()),n}):r.promise}},a.defaults=s.prototype,a.Builder=s,a.filterStatus=function(e){var n,r,i=this.log;if(r=typeof e,"function"===r)n=e;else{if("number"!==r)throw"validStatus type "+r+" unsupported";n=function(t){return t===e}}return function(e){var r=0;try{r=e.status}catch(o){i("Qajax: failed to read xhr.status")}return 1223===r&&(r=204),n(r)?t.resolve(e):t.reject(e)}},a.filterSuccess=a.filterStatus(function(t){return t>=200&&300>t||304===t}),a.toJSON=function(e){return t.fcall(function(){return JSON.parse(e.responseText)})},a.getJSON=function(t){return a({url:t,method:"GET"}).then(a.filterSuccess).then(a.toJSON)},a.serialize=r,a});


},{}],58:[function(require,module,exports){
for(var now=require("performance-now"),global="undefined"==typeof window?{}:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=global["request"+suffix],caf=global["cancel"+suffix]||global["cancelRequest"+suffix],isNative=!0,i=0;i<vendors.length&&!raf;i++)raf=global[vendors[i]+"Request"+suffix],caf=global[vendors[i]+"Cancel"+suffix]||global[vendors[i]+"CancelRequest"+suffix];if(!raf||!caf){isNative=!1;var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(e){if(0===queue.length){var a=now(),l=Math.max(0,frameDuration-(a-last));last=l+a,setTimeout(function(){var e=queue.slice(0);queue.length=0;for(var a=0;a<e.length;a++)if(!e[a].cancelled)try{e[a].callback(last)}catch(l){setTimeout(function(){throw l},0)}},Math.round(l))}return queue.push({handle:++id,callback:e,cancelled:!1}),id},caf=function(e){for(var a=0;a<queue.length;a++)queue[a].handle===e&&(queue[a].cancelled=!0)}}module.exports=function(e){return isNative?raf.call(global,function(){try{e.apply(this,arguments)}catch(a){setTimeout(function(){throw a},0)}}):raf.call(global,e)},module.exports.cancel=function(){caf.apply(global,arguments)};


},{"performance-now":59}],59:[function(require,module,exports){
(function (process){
(function(){var e,n,r;"undefined"!=typeof performance&&null!==performance&&performance.now?module.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(module.exports=function(){return(e()-r)/1e6},n=process.hrtime,e=function(){var e;return e=n(),1e9*e[0]+e[1]},r=e()):Date.now?(module.exports=function(){return Date.now()-r},r=Date.now()):(module.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this);


}).call(this,require('_process'))
},{"_process":8}],60:[function(require,module,exports){
module.exports=function(a,t){var m=a[2],n=a[3],h=t[2],r=t[3],M=m/n;return m>h&&(m=h,n=~~(m/M)),n>r&&(n=r,m=~~(n*M)),[t[0]+Math.max(0,Math.min(a[0],h-m)),t[1]+Math.max(0,Math.min(a[1],r-n)),m,n]};


},{}],61:[function(require,module,exports){
function rectCrop(t,r){return r||(r=[.5,.5]),function(e,h){var i=e.width/e.height,o=h.width/h.height,c=Math.max(i,o),n=[i/c*h.width*t,o/c*h.height*t];return[h.width*r[0]-n[0]/2,h.height*r[1]-n[1]/2,n[0],n[1]]}}rectCrop.largest=rectCrop(1),module.exports=rectCrop;


},{}],62:[function(require,module,exports){
function mix(r,n,o){return r*(1-o)+n*o}module.exports=function(r,n,o){for(var t=[],u=0;4>u;++u)t[u]=mix(r[u],n[u],o);return t};


},{}],63:[function(require,module,exports){
"use strict";function get(e){return e in memo?memo[e]:memo[e]=prefix(e)}function prefix(e){var r,t=e.replace(/-([a-z])/g,function(e,r){return r.toUpperCase()}),i=prefixes.length;if(void 0!==style[t])return t;for(t=capitalize(e);i--;)if(r=prefixes[i]+t,void 0!==style[r])return r;throw new Error("unable to prefix "+e)}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}function dashedPrefix(e){var r=get(e),t=/([A-Z])/g;return t.test(r)&&(r=(hasPrefix.test(r)?"-":"")+r.replace(t,"-$1")),r.toLowerCase()}var style=document.createElement("p").style,prefixes="O ms Moz webkit".split(" "),hasPrefix=/^(o|ms|moz|webkit)/,upper=/([A-Z])/g,memo={};module.exports=get,module.exports.dash=dashedPrefix;


},{}]},{},[1]);
